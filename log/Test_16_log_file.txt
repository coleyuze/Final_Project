root@9cf9c6d4615a:~/test20230317base/task2# python -m src.train --gpu_ids='2' --bert_seq_length=256 --learning_rate=1e-4 --bert_learning_rate=5e-5 --savedmodel_path='data/checkpoint/0703_swa_10' --max_epochs=10  --adam_epsilon=1e-6 --weight_decay=0.01 --test_batch_size=64 --val_batch_size=64 --batch_size=16 --embedding_freeze
addle !!!!!!!!!!!!!!!!!!!!!!!!!!!!
The GPUS ids:  2
Some weights of the model checkpoint at roberta-base were not used when initializing RobertaModel: ['lm_head.decoder.weight', 'lm_head.dense.bias', 'lm_head.layer_norm.bias', 'lm_head.bias', 'lm_head.layer_norm.weight', 'lm_head.dense.weight']
- This IS expected if you are initializing RobertaModel from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing RobertaModel from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
The train data length:  222
The valid data length:  10
冻结word embedding参数不训练!
2023-04-10 19:00:16 - INFO - Training/evaluation parameters: Namespace(adam_epsilon=1e-06, alpha=0, batch_size=16, bert_cache='data/bert_cache/', bert_dir='roberta-base', bert_embedding_size=768, bert_hidden_dropout_prob=0.1, bert_hidden_size=768, bert_learning_rate=5e-05, bert_max_steps=30000, bert_seq_length=256, bert_warmup_steps=5000, best_score=0.75, ckpt_file=None, class_label=3, constant_lr=False, device='cuda', distributed_train=False, dropout=0.3, ema_decay=0.999, ema_start=-1, embedding_freeze=True, fgm=0, gamma=0, gamma_focal=-1, gpu_ids='2', gradient_accumulation_steps=2, learning_rate=0.0001, max_epochs=10, max_grad_norm=1.0, max_steps=2220, minimum_lr=0.0, n_gpu=1, pgd=0, premise=False, pretrain_model_path=None, print_steps=100, result_file='result.tsv', save_steps=100, savedmodel_path='data/checkpoint/0703_swa_10', seed=42, swa_lr=5e-05, swa_start=-1, test_batch_size=64, test_path='data/validation.tsv', train_path='data/train.tsv', use_rdrop=False, val_batch_size=64, valid_path='data/validation.tsv', warmup_rate=0.1, warmup_steps=222, weight_decay=0.01)
Training::  45%|███████████████████████████████████████████████████████████████████████▊                                                                                         | 99/222 [00:22<00:27,  4.44it/s]2023-04-10 19:00:38 - INFO - Epoch 0total_step 100eta 00:07:55:loss 0.881, acc 0.688
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:02<00:00,  3.41it/s]
2023-04-10 19:00:41 - INFO - current_score 0.5217157525327348█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:02<00:00,  4.00it/s]
Training::  90%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                | 199/222 [00:47<00:05,  4.35it/s]2023-04-10 19:01:04 - INFO - Epoch 0total_step 200eta 00:08:05:loss 1.080, acc 0.562
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:02<00:00,  3.45it/s]
2023-04-10 19:01:07 - INFO - current_score 0.5318990203849359█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:02<00:00,  4.00it/s]
Training:: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 222/222 [00:55<00:00,  3.97it/s]
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:02<00:00,  3.39it/s]
Training::  35%|███████████████████████████████████████████████████████▊                                                                                                         | 77/222 [00:17<00:33,  4.37it/s]2023-04-10 19:01:33 - INFO - Epoch 1total_step 300eta 00:08:10:loss 0.595, acc 0.750
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:03<00:00,  3.23it/s]
2023-04-10 19:01:36 - INFO - current_score 0.6062352462352463█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:03<00:00,  3.90it/s]
Training::  80%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                | 177/222 [00:43<00:10,  4.44it/s]2023-04-10 19:01:58 - INFO - Epoch 1total_step 400eta 00:07:45:loss 0.770, acc 0.750
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:02<00:00,  3.39it/s]
2023-04-10 19:02:01 - INFO - current_score 0.6011219433687188█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:02<00:00,  3.87it/s]
Training:: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 222/222 [00:56<00:00,  3.93it/s]
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:03<00:00,  3.32it/s]
Training::  25%|███████████████████████████████████████▉                                                                                                                         | 55/222 [00:11<00:32,  5.19it/s]2023-04-10 19:02:26 - INFO - Epoch 2total_step 500eta 00:07:28:loss 0.648, acc 0.875
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:02<00:00,  3.83it/s]
2023-04-10 19:02:29 - INFO - current_score 0.6572066410784547█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:02<00:00,  4.40it/s]
Training::  70%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                | 155/222 [00:35<00:15,  4.42it/s]2023-04-10 19:02:50 - INFO - Epoch 2total_step 600eta 00:06:55:loss 0.693, acc 0.812
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:02<00:00,  3.47it/s]
2023-04-10 19:02:53 - INFO - current_score 0.7022990108008085█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:02<00:00,  3.99it/s]
Training:: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 222/222 [00:53<00:00,  4.17it/s]
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:02<00:00,  3.41it/s]
Training::  15%|███████████████████████▉                                                                                                                                         | 33/222 [00:07<00:42,  4.43it/s]2023-04-10 19:03:18 - INFO - Epoch 3total_step 700eta 00:06:35:loss 0.706, acc 0.688
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:02<00:00,  3.45it/s]
2023-04-10 19:03:21 - INFO - current_score 0.6963213315217391█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:02<00:00,  4.00it/s]
Training::  60%|███████████████████████████████████████████████████████████████████████████████████████████████▊                                                                | 133/222 [00:33<00:19,  4.48it/s]2023-04-10 19:03:44 - INFO - Epoch 3total_step 800eta 00:06:09:loss 0.452, acc 0.875
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:02<00:00,  3.48it/s]
2023-04-10 19:03:47 - INFO - current_score 0.6785442769878749█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:02<00:00,  3.96it/s]
Training:: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 222/222 [00:56<00:00,  3.95it/s]
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:02<00:00,  3.44it/s]
Training::   5%|███████▉                                                                                                                                                         | 11/222 [00:02<00:48,  4.36it/s]2023-04-10 19:04:12 - INFO - Epoch 4total_step 900eta 00:05:46:loss 0.466, acc 0.875
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:02<00:00,  3.39it/s]
2023-04-10 19:04:15 - INFO - current_score 0.6861624035208941█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:02<00:00,  3.90it/s]
Training::  50%|████████████████████████████████████████████████████████████████████████████████                                                                                | 111/222 [00:28<00:25,  4.40it/s]2023-04-10 19:04:38 - INFO - Epoch 4total_step 1000eta 00:05:19:loss 0.401, acc 0.938
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:02<00:00,  3.40it/s]
2023-04-10 19:04:41 - INFO - current_score 0.7098833213355273█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:02<00:00,  3.92it/s]
Training::  95%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████        | 211/222 [00:51<00:02,  4.92it/s]2023-04-10 19:05:02 - INFO - Epoch 4total_step 1100eta 00:04:50:loss 0.182, acc 0.938
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:02<00:00,  3.45it/s]
2023-04-10 19:05:05 - INFO - current_score 0.7246834523933089█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:02<00:00,  3.99it/s]
Training:: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 222/222 [00:57<00:00,  3.89it/s]
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:02<00:00,  3.45it/s]
Training::  40%|████████████████████████████████████████████████████████████████▌                                                                                                | 89/222 [00:20<00:28,  4.67it/s]2023-04-10 19:05:30 - INFO - Epoch 5total_step 1200eta 00:04:26:loss 0.592, acc 0.875
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:02<00:00,  3.43it/s]
2023-04-10 19:05:33 - INFO - current_score 0.7223036470238007█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:02<00:00,  3.98it/s]
Training::  85%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                       | 189/222 [00:45<00:07,  4.32it/s]2023-04-10 19:05:56 - INFO - Epoch 5total_step 1300eta 00:04:00:loss 0.366, acc 0.938
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:03<00:00,  3.33it/s]
2023-04-10 19:05:59 - INFO - current_score 0.7427448058180023█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:03<00:00,  3.80it/s]
Training:: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 222/222 [00:56<00:00,  3.94it/s]
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:02<00:00,  3.42it/s]
Training::  30%|████████████████████████████████████████████████▌                                                                                                                | 67/222 [00:15<00:35,  4.38it/s]2023-04-10 19:06:24 - INFO - Epoch 6total_step 1400eta 00:03:35:loss 0.412, acc 0.812
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:02<00:00,  3.50it/s]
2023-04-10 19:06:27 - INFO - current_score 0.7289430883511048█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:02<00:00,  4.09it/s]
Training::  75%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                       | 167/222 [00:40<00:12,  4.39it/s]2023-04-10 19:06:50 - INFO - Epoch 6total_step 1500eta 00:03:09:loss 0.111, acc 1.000
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:02<00:00,  3.47it/s]
2023-04-10 19:06:53 - INFO - current_score 0.7382857049615434█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:02<00:00,  4.00it/s]
Training:: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 222/222 [00:56<00:00,  3.96it/s]
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:02<00:00,  3.41it/s]
Training::  20%|████████████████████████████████▋                                                                                                                                | 45/222 [00:10<00:36,  4.87it/s]2023-04-10 19:07:18 - INFO - Epoch 7total_step 1600eta 00:02:43:loss 0.111, acc 1.000
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:02<00:00,  3.81it/s]
2023-04-10 19:07:21 - INFO - current_score 0.7493333333333334█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:02<00:00,  4.39it/s]
Training::  65%|████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                       | 145/222 [00:33<00:17,  4.44it/s]2023-04-10 19:07:42 - INFO - Epoch 7total_step 1700eta 00:02:16:loss 0.058, acc 1.000
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:02<00:00,  3.45it/s]
2023-04-10 19:07:45 - INFO - current_score 0.7359523724565218█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:02<00:00,  3.97it/s]
Training:: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 222/222 [00:53<00:00,  4.13it/s]
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:02<00:00,  3.44it/s]
Training::  10%|████████████████▋                                                                                                                                                | 23/222 [00:05<00:44,  4.48it/s]2023-04-10 19:08:10 - INFO - Epoch 8total_step 1800eta 00:01:50:loss 0.093, acc 1.000
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:02<00:00,  3.41it/s]
2023-04-10 19:08:13 - INFO - current_score 0.7223731515229174█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:02<00:00,  3.92it/s]
Training::  55%|████████████████████████████████████████████████████████████████████████████████████████▋                                                                       | 123/222 [00:30<00:22,  4.35it/s]2023-04-10 19:08:36 - INFO - Epoch 8total_step 1900eta 00:01:24:loss 0.042, acc 1.000
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:02<00:00,  3.41it/s]
2023-04-10 19:08:41 - INFO - best_score 0.7594465323450603████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:02<00:00,  3.96it/s]
2023-04-10 19:08:41 - INFO - current_score 0.7594465323450603
Training:: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 222/222 [00:58<00:00,  3.82it/s]
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:02<00:00,  3.43it/s]
Training::   0%|▋                                                                                                                                                                 | 1/222 [00:00<00:49,  4.45it/s]2023-04-10 19:09:06 - INFO - Epoch 9total_step 2000eta 00:00:58:loss 0.245, acc 0.938
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:02<00:00,  3.52it/s]
2023-04-10 19:09:09 - INFO - current_score 0.755454260000989██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:02<00:00,  4.12it/s]
Training::  45%|████████████████████████████████████████████████████████████████████████▊                                                                                       | 101/222 [00:23<00:25,  4.83it/s]2023-04-10 19:09:30 - INFO - Epoch 9total_step 2100eta 00:00:31:loss 0.260, acc 0.875
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:02<00:00,  3.81it/s]
2023-04-10 19:09:33 - INFO - current_score 0.7315250084617988█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:02<00:00,  4.37it/s]
Training::  91%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊               | 201/222 [00:48<00:04,  4.45it/s]2023-04-10 19:09:55 - INFO - Epoch 9total_step 2200eta 00:00:05:loss 0.415, acc 0.875
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:02<00:00,  3.45it/s]
2023-04-10 19:09:58 - INFO - current_score 0.7401639782530081█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:02<00:00,  4.00it/s]
Training:: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 222/222 [00:56<00:00,  3.94it/s]
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:02<00:00,  3.49it/s