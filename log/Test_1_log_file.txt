root@9cf9c6d4615a:~/stance_detection/stance_detection# cd /root/task2V2
root@9cf9c6d4615a:~/task2V2# python -m src.train --gpu_ids='2' --bert_seq_length=128 --learning_rate=1e-4 --bert_learning_rate=5e-5 --savedmodel_path='data/checkpoint/0703_swa_10' --max_epochs=10 --swa_start=5 --swa_lr=2e-5 --batch_size=16 --adam_epsilon=1e-6 --weight_decay=0.01 --bert_dir="digitalepidemiologylab/covid-twitter-bert-v2"
The GPUS ids:  2
Some weights of the model checkpoint at digitalepidemiologylab/covid-twitter-bert-v2 were not used when initializing BertModel: ['cls.predictions.decoder.bias', 'cls.seq_relationship.bias', 'cls.predictions.transform.dense.bias', 'cls.predictions.transform.dense.weight', 'cls.predictions.bias', 'cls.seq_relationship.weight', 'cls.predictions.transform.LayerNorm.weight', 'cls.predictions.decoder.weight', 'cls.predictions.transform.LayerNorm.bias']
- This IS expected if you are initializing BertModel from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing BertModel from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
The train data length:  222
The valid data length:  10
使用SWA！
2023-04-06 19:59:26 - INFO - Training/evaluation parameters: Namespace(adam_epsilon=1e-06, alpha=0, batch_size=16, bert_cache='data/bert_cache/', bert_dir='digitalepidemiologylab/covid-twitter-bert-v2', bert_embedding_size=768, bert_hidden_dropout_prob=0.1, bert_hidden_size=768, bert_learning_rate=5e-05, bert_max_steps=30000, bert_seq_length=128, bert_warmup_steps=5000, best_score=0.75, ckpt_file=None, class_label=3, constant_lr=False, device='cuda', distributed_train=False, dropout=0.3, ema_decay=0.999, ema_start=-1, embedding_freeze=False, fgm=0, gamma=0, gamma_focal=-1, gpu_ids='2', gradient_accumulation_steps=2, learning_rate=0.0001, max_epochs=10, max_grad_norm=1.0, max_steps=2220, minimum_lr=0.0, n_gpu=1, pgd=0, premise=False, pretrain_model_path=None, print_steps=100, result_file='result.tsv', save_steps=100, savedmodel_path='data/checkpoint/0703_swa_10', seed=42, swa_lr=2e-05, swa_start=5, test_batch_size=64, test_path='data/validation.tsv', train_path='data/train.tsv', use_rdrop=False, val_batch_size=64, valid_path='data/validation.tsv', warmup_rate=0.1, warmup_steps=222, weight_decay=0.01)
Training::  45%|███████████████████████████████████████████████████████████████████████▊                                                                                         | 99/222 [00:35<00:42,  2.92it/s]2023-04-06 20:00:01 - INFO - Epoch 0total_step 100eta 00:12:36:loss 0.590, acc 0.688
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:03<00:00,  3.03it/s]
2023-04-06 20:00:27 - INFO - best_score 0.7977835492922014████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:03<00:00,  3.50it/s]
2023-04-06 20:00:27 - INFO - current_score 0.7977835492922014
Training::  90%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                | 199/222 [01:35<00:07,  2.93it/s]2023-04-06 20:01:01 - INFO - Epoch 0total_step 200eta 00:16:07:loss 0.607, acc 0.688
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:03<00:00,  3.00it/s]
2023-04-06 20:01:27 - INFO - best_score 0.8280275131044███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:03<00:00,  3.48it/s]
2023-04-06 20:01:27 - INFO - current_score 0.8280275131044
Training:: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 222/222 [02:08<00:00,  1.73it/s]
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:03<00:00,  3.02it/s]
2023-04-06 20:02:00 - INFO - best_score 0.831380788478337
Training::  35%|███████████████████████████████████████████████████████▊                                                                                                         | 77/222 [00:26<00:49,  2.91it/s]2023-04-06 20:02:27 - INFO - Epoch 1total_step 300eta 00:19:18:loss 0.219, acc 0.875
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:03<00:00,  3.02it/s]
2023-04-06 20:02:30 - INFO - current_score 0.8263945981656328█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:03<00:00,  3.50it/s]
Training::  80%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                | 177/222 [01:04<00:15,  2.93it/s]2023-04-06 20:03:04 - INFO - Epoch 1total_step 400eta 00:16:34:loss 0.311, acc 0.875
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:03<00:00,  3.00it/s]
2023-04-06 20:03:08 - INFO - current_score 0.8266411513532872█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:03<00:00,  3.47it/s]
Training:: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 222/222 [01:23<00:00,  2.67it/s]
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:03<00:00,  2.98it/s]
Training::  25%|███████████████████████████████████████▉                                                                                                                         | 55/222 [00:18<00:57,  2.92it/s]2023-04-06 20:03:46 - INFO - Epoch 2total_step 500eta 00:14:53:loss 0.028, acc 1.000
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:03<00:00,  3.00it/s]
2023-04-06 20:04:11 - INFO - best_score 0.8401474954880883████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:03<00:00,  3.47it/s]
2023-04-06 20:04:11 - INFO - current_score 0.8401474954880883
Training::  70%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                | 155/222 [01:18<00:23,  2.89it/s]2023-04-06 20:04:45 - INFO - Epoch 2total_step 600eta 00:14:23:loss 0.061, acc 1.000
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:03<00:00,  3.01it/s]
2023-04-06 20:05:12 - INFO - best_score 0.847287239813054█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:03<00:00,  3.47it/s]
2023-04-06 20:05:12 - INFO - current_score 0.847287239813054
Training:: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 222/222 [02:08<00:00,  1.73it/s]
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:03<00:00,  3.01it/s]
2023-04-06 20:06:02 - INFO - best_score 0.8503447440303111
Training::  15%|███████████████████████▉                                                                                                                                         | 33/222 [00:11<01:05,  2.87it/s]2023-04-06 20:06:14 - INFO - Epoch 3total_step 700eta 00:14:45:loss 0.105, acc 0.938
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:03<00:00,  3.00it/s]
2023-04-06 20:06:39 - INFO - best_score 0.8520808436001648████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:03<00:00,  3.47it/s]
2023-04-06 20:06:39 - INFO - current_score 0.8520808436001648
Training::  60%|███████████████████████████████████████████████████████████████████████████████████████████████▊                                                                | 133/222 [01:11<00:30,  2.92it/s]2023-04-06 20:07:14 - INFO - Epoch 3total_step 800eta 00:13:50:loss 0.133, acc 0.938
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:03<00:00,  2.99it/s]
2023-04-06 20:07:43 - INFO - best_score 0.8538765845442411████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:03<00:00,  3.46it/s]
2023-04-06 20:07:43 - INFO - current_score 0.8538765845442411
Training:: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 222/222 [02:11<00:00,  1.69it/s]
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:03<00:00,  2.98it/s]
Training::   5%|███████▉                                                                                                                                                         | 11/222 [00:03<01:13,  2.87it/s]2023-04-06 20:08:21 - INFO - Epoch 4total_step 900eta 00:13:04:loss 0.014, acc 1.000
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:03<00:00,  2.99it/s]
2023-04-06 20:08:24 - INFO - current_score 0.8505314208435437█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:03<00:00,  3.46it/s]
Training::  50%|████████████████████████████████████████████████████████████████████████████████                                                                                | 111/222 [00:41<00:38,  2.91it/s]2023-04-06 20:08:59 - INFO - Epoch 4total_step 1000eta 00:11:38:loss 0.025, acc 1.000
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:03<00:00,  2.97it/s]
2023-04-06 20:09:02 - INFO - current_score 0.8486641536357422█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:03<00:00,  3.43it/s]
Training::  95%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████        | 211/222 [01:19<00:03,  2.89it/s]2023-04-06 20:09:37 - INFO - Epoch 4total_step 1100eta 00:10:22:loss 0.119, acc 0.938
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:03<00:00,  2.96it/s]
2023-04-06 20:09:40 - INFO - current_score 0.8471899427059013█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:03<00:00,  3.43it/s]
Training:: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 222/222 [01:26<00:00,  2.55it/s]
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:03<00:00,  2.97it/s]
Training::  40%|████████████████████████████████████████████████████████████████▌                                                                                                | 89/222 [00:30<00:46,  2.89it/s]2023-04-06 20:10:18 - INFO - Epoch 5total_step 1200eta 00:09:14:loss 0.013, acc 1.000
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:03<00:00,  2.99it/s]
2023-04-06 20:10:21 - INFO - current_score 0.8536150665284663█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:03<00:00,  3.45it/s]
Training::  85%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                       | 189/222 [01:08<00:11,  2.89it/s]2023-04-06 20:10:56 - INFO - Epoch 5total_step 1300eta 00:08:08:loss 0.137, acc 0.938
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:03<00:00,  2.98it/s]
2023-04-06 20:10:59 - INFO - current_score 0.8500116497770016█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:03<00:00,  3.44it/s]
Training:: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 222/222 [01:23<00:00,  2.66it/s]
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:03<00:00,  2.98it/s]
Training::  30%|████████████████████████████████████████████████▌                                                                                                                | 67/222 [00:23<00:53,  2.90it/s]2023-04-06 20:11:37 - INFO - Epoch 6total_step 1400eta 00:07:08:loss 0.009, acc 1.000
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:03<00:00,  2.96it/s]
2023-04-06 20:11:41 - INFO - current_score 0.8467226066394191█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:03<00:00,  3.41it/s]
Training::  75%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                       | 167/222 [01:00<00:19,  2.82it/s]2023-04-06 20:12:15 - INFO - Epoch 6total_step 1500eta 00:06:09:loss 0.016, acc 1.000
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:03<00:00,  2.96it/s]
2023-04-06 20:12:19 - INFO - current_score 0.844936864064781██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:03<00:00,  3.43it/s]
Training:: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 222/222 [01:23<00:00,  2.66it/s]
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:03<00:00,  2.98it/s]
Training::  20%|████████████████████████████████▋                                                                                                                                | 45/222 [00:15<01:01,  2.90it/s]2023-04-06 20:12:57 - INFO - Epoch 7total_step 1600eta 00:05:14:loss 0.006, acc 1.000
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:03<00:00,  2.98it/s]
2023-04-06 20:13:00 - INFO - current_score 0.8450738688026187█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:03<00:00,  3.45it/s]
Training::  65%|████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                       | 145/222 [00:53<00:26,  2.90it/s]2023-04-06 20:13:35 - INFO - Epoch 7total_step 1700eta 00:04:19:loss 0.008, acc 1.000
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:03<00:00,  2.99it/s]
2023-04-06 20:13:38 - INFO - current_score 0.8450738688026187█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:03<00:00,  3.46it/s]
Training:: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 222/222 [01:23<00:00,  2.65it/s]
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:03<00:00,  3.00it/s]
Training::  10%|████████████████▋                                                                                                                                                | 23/222 [00:08<01:11,  2.79it/s]2023-04-06 20:14:16 - INFO - Epoch 8total_step 1800eta 00:03:27:loss 0.364, acc 0.875
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:03<00:00,  3.00it/s]
2023-04-06 20:14:19 - INFO - current_score 0.8450738688026187█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:03<00:00,  3.46it/s]
Training::  55%|████████████████████████████████████████████████████████████████████████████████████████▋                                                                       | 123/222 [00:46<00:33,  2.91it/s]2023-04-06 20:14:54 - INFO - Epoch 8total_step 1900eta 00:02:36:loss 0.014, acc 1.000
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:03<00:00,  2.99it/s]
2023-04-06 20:14:57 - INFO - current_score 0.8467226066394191█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:03<00:00,  3.46it/s]
Training:: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 222/222 [01:23<00:00,  2.65it/s]
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:03<00:00,  2.99it/s]
Training::   0%|▋                                                                                                                                                                 | 1/222 [00:00<01:17,  2.86it/s]2023-04-06 20:15:35 - INFO - Epoch 9total_step 2000eta 00:01:46:loss 0.014, acc 1.000
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:03<00:00,  2.99it/s]
2023-04-06 20:15:39 - INFO - current_score 0.8484555873226409█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:03<00:00,  3.46it/s]
Training::  45%|████████████████████████████████████████████████████████████████████████▊                                                                                       | 101/222 [00:38<00:41,  2.91it/s]2023-04-06 20:16:13 - INFO - Epoch 9total_step 2100eta 00:00:57:loss 0.002, acc 1.000
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:03<00:00,  2.99it/s]
2023-04-06 20:16:17 - INFO - current_score 0.8502356970325441█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:03<00:00,  3.45it/s]
Training::  91%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊               | 201/222 [01:16<00:07,  2.93it/s]2023-04-06 20:16:51 - INFO - Epoch 9total_step 2200eta 00:00:09:loss 0.004, acc 1.000
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:03<00:00,  2.99it/s]
2023-04-06 20:16:55 - INFO - current_score 0.8502356970325441█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:03<00:00,  3.46it/s]
Training:: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 222/222 [01:26<00:00,  2.56it/s]
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:03<00:00,  2.97it/s