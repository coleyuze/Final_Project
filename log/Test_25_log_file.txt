root@9cf9c6d4615a:~/test20230317base/task2# python -m src.train --gpu_ids='2' --bert_seq_length=128 --learning_rate=5e-5 --bert_learning_rate=5e-5 --savedmodel_path='data/checkpoint/0703_swa_10' --max_epochs=10  --adam_epsilon=1e-6 --weight_decay=0.01 --test_batch_size=64 --val_batch_size=64 --batch_size=16 
addle !!!!!!!!!!!!!!!!!!!!!!!!!!!!
The GPUS ids:  2
Some weights of the model checkpoint at roberta-base were not used when initializing RobertaModel: ['lm_head.decoder.weight', 'lm_head.layer_norm.bias', 'lm_head.layer_norm.weight', 'lm_head.dense.bias', 'lm_head.dense.weight', 'lm_head.bias']
- This IS expected if you are initializing RobertaModel from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing RobertaModel from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
The train data length:  222
The valid data length:  10
2023-04-11 16:21:18 - INFO - Training/evaluation parameters: Namespace(adam_epsilon=1e-06, alpha=0, batch_size=16, bert_cache='data/bert_cache/', bert_dir='roberta-base', bert_embedding_size=768, bert_hidden_dropout_prob=0.1, bert_hidden_size=768, bert_learning_rate=5e-05, bert_max_steps=30000, bert_seq_length=128, bert_warmup_steps=5000, best_score=0.75, ckpt_file=None, class_label=3, constant_lr=False, device='cuda', distributed_train=False, dropout=0.3, ema_decay=0.999, ema_start=-1, embedding_freeze=False, fgm=0, gamma=0, gamma_focal=-1, gpu_ids='2', gradient_accumulation_steps=2, learning_rate=5e-05, max_epochs=10, max_grad_norm=1.0, max_steps=2220, minimum_lr=0.0, n_gpu=1, pgd=0, premise=False, pretrain_model_path=None, print_steps=100, result_file='result.tsv', save_steps=100, savedmodel_path='data/checkpoint/0703_swa_10', seed=42, swa_lr=5e-05, swa_start=-1, test_batch_size=64, test_path='data/validation.tsv', train_path='data/train.tsv', use_rdrop=False, val_batch_size=64, valid_path='data/validation.tsv', warmup_rate=0.1, warmup_steps=222, weight_decay=0.01)
Training::  45%|███████████████████████████████████████████████████████████████████████▊                                                                                         | 99/222 [00:13<00:14,  8.53it/s]2023-04-11 16:21:31 - INFO - Epoch 0total_step 100eta 00:04:48:loss 0.960, acc 0.625
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:01<00:00,  7.29it/s]
2023-04-11 16:21:33 - INFO - current_score 0.5057852265673495█████████████████████████████████████████████████████████████████████████████████████████████████████▊                | 9/10 [00:01<00:00,  7.06it/s]
Training::  90%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                | 199/222 [00:26<00:02,  8.43it/s]2023-04-11 16:21:44 - INFO - Epoch 0total_step 200eta 00:04:30:loss 1.065, acc 0.562
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:01<00:00,  7.28it/s]
2023-04-11 16:21:46 - INFO - current_score 0.5473773306644685█████████████████████████████████████████████████████████████████████████████████████████████████████▊                | 9/10 [00:01<00:00,  6.84it/s]
Training:: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 222/222 [00:30<00:00,  7.20it/s]
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:01<00:00,  7.30it/s]
Training::  35%|███████████████████████████████████████████████████████▊                                                                                                         | 77/222 [00:09<00:17,  8.26it/s]2023-04-11 16:21:59 - INFO - Epoch 1total_step 300eta 00:04:26:loss 0.671, acc 0.750
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:01<00:00,  6.72it/s]
2023-04-11 16:22:01 - INFO - current_score 0.5924633699633699█████████████████████████████████████████████████████████████████████████████████████████████████████▊                | 9/10 [00:01<00:00,  6.86it/s]
Training::  80%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                | 177/222 [00:22<00:05,  8.49it/s]2023-04-11 16:22:13 - INFO - Epoch 1total_step 400eta 00:04:10:loss 0.733, acc 0.812
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:01<00:00,  7.23it/s]
2023-04-11 16:22:14 - INFO - current_score 0.6557304148639727█████████████████████████████████████████████████████████████████████████████████████████████████████▊                | 9/10 [00:01<00:00,  6.62it/s]
Training:: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 222/222 [00:29<00:00,  7.52it/s]
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:01<00:00,  7.58it/s]
Training::  25%|███████████████████████████████████████▉                                                                                                                         | 55/222 [00:06<00:20,  8.20it/s]2023-04-11 16:22:27 - INFO - Epoch 2total_step 500eta 00:03:58:loss 0.567, acc 0.812
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:01<00:00,  7.25it/s]
2023-04-11 16:22:28 - INFO - current_score 0.7166622755292671█████████████████████████████████████████████████████████████████████████████████████████████████████▊                | 9/10 [00:01<00:00,  6.77it/s]
Training::  70%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                | 155/222 [00:19<00:08,  8.29it/s]2023-04-11 16:22:41 - INFO - Epoch 2total_step 600eta 00:03:43:loss 0.581, acc 0.750
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:01<00:00,  7.19it/s]
2023-04-11 16:22:42 - INFO - current_score 0.7303091106164805█████████████████████████████████████████████████████████████████████████████████████████████████████▊                | 9/10 [00:01<00:00,  6.66it/s]
Training:: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 222/222 [00:29<00:00,  7.58it/s]
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:01<00:00,  7.15it/s]
Training::  15%|███████████████████████▉                                                                                                                                         | 33/222 [00:03<00:23,  8.15it/s]2023-04-11 16:22:56 - INFO - Epoch 3total_step 700eta 00:03:32:loss 0.757, acc 0.750
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:01<00:00,  7.47it/s]
2023-04-11 16:22:57 - INFO - current_score 0.7001014944328829█████████████████████████████████████████████████████████████████████████████████████████████████████▊                | 9/10 [00:01<00:00,  7.05it/s]
Training::  60%|███████████████████████████████████████████████████████████████████████████████████████████████▊                                                                | 133/222 [00:17<00:10,  8.13it/s]2023-04-11 16:23:09 - INFO - Epoch 3total_step 800eta 00:03:17:loss 0.597, acc 0.812
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:01<00:00,  7.48it/s]
2023-04-11 16:23:10 - INFO - current_score 0.7234411813705386█████████████████████████████████████████████████████████████████████████████████████████████████████▊                | 9/10 [00:01<00:00,  7.12it/s]
Training:: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 222/222 [00:29<00:00,  7.57it/s]
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:01<00:00,  7.39it/s]
2023-04-11 16:23:24 - INFO - best_score 0.7525005365924603
Training::   5%|███████▉                                                                                                                                                         | 11/222 [00:01<00:24,  8.47it/s]2023-04-11 16:23:26 - INFO - Epoch 4total_step 900eta 00:03:08:loss 0.443, acc 0.812
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:01<00:00,  7.45it/s]
2023-04-11 16:23:27 - INFO - current_score 0.730968512514367██████████████████████████████████████████████████████████████████████████████████████████████████████▊                | 9/10 [00:01<00:00,  7.17it/s]
Training::  50%|███████████████████████████████████████████████████████████████████████████████▎                                                                                | 110/222 [00:13<00:10, 10.21it/s]2023-04-11 16:23:38 - INFO - Epoch 4total_step 1000eta 00:02:51:loss 0.448, acc 0.875
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:01<00:00,  8.51it/s]
2023-04-11 16:23:39 - INFO - current_score 0.7495008343349483█████████████████████████████████████████████████████████████████████████████████████████████████████▊                | 9/10 [00:01<00:00,  7.96it/s]
Training::  95%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎        | 210/222 [00:24<00:01, 10.17it/s]2023-04-11 16:23:49 - INFO - Epoch 4total_step 1100eta 00:02:34:loss 0.047, acc 1.000
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:01<00:00,  8.77it/s]
2023-04-11 16:23:50 - INFO - current_score 0.7484000823171659█████████████████████████████████████████████████████████████████████████████████████████████████████▊                | 9/10 [00:01<00:00,  8.38it/s]
Training:: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 222/222 [00:26<00:00,  8.22it/s]
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:01<00:00,  8.95it/s]
Training::  40%|███████████████████████████████████████████████████████████████▊                                                                                                 | 88/222 [00:08<00:13, 10.12it/s]2023-04-11 16:24:02 - INFO - Epoch 5total_step 1200eta 00:02:19:loss 0.201, acc 0.938
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:01<00:00,  8.66it/s]
2023-04-11 16:24:03 - INFO - current_score 0.7300230156970011█████████████████████████████████████████████████████████████████████████████████████████████████████▊                | 9/10 [00:01<00:00,  8.32it/s]
Training::  85%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                       | 189/222 [00:19<00:03, 10.32it/s]2023-04-11 16:24:13 - INFO - Epoch 5total_step 1300eta 00:02:03:loss 0.040, acc 1.000
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:01<00:00,  8.67it/s]
2023-04-11 16:24:14 - INFO - current_score 0.7507414391844367█████████████████████████████████████████████████████████████████████████████████████████████████████▊                | 9/10 [00:01<00:00,  8.15it/s]
Training:: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 222/222 [00:24<00:00,  9.13it/s]
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:01<00:00,  8.62it/s]
Training::  30%|████████████████████████████████████████████████▌                                                                                                                | 67/222 [00:07<00:19,  8.12it/s]2023-04-11 16:24:26 - INFO - Epoch 6total_step 1400eta 00:01:50:loss 0.049, acc 1.000
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:01<00:00,  7.28it/s]
2023-04-11 16:24:28 - INFO - current_score 0.7449410967031104█████████████████████████████████████████████████████████████████████████████████████████████████████▊                | 9/10 [00:01<00:00,  6.92it/s]
Training::  75%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                       | 167/222 [00:21<00:07,  7.86it/s]2023-04-11 16:24:40 - INFO - Epoch 6total_step 1500eta 00:01:37:loss 0.139, acc 0.938
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:01<00:00,  6.71it/s]
2023-04-11 16:24:41 - INFO - current_score 0.725656581982999██████████████████████████████████████████████████████████████████████████████████████████████████████▊                | 9/10 [00:01<00:00,  6.53it/s]
Training:: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 222/222 [00:30<00:00,  7.39it/s]
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:01<00:00,  7.32it/s]
2023-04-11 16:24:53 - INFO - best_score 0.7655933807051339
Training::  20%|████████████████████████████████▋                                                                                                                                | 45/222 [00:05<00:22,  7.97it/s]2023-04-11 16:24:58 - INFO - Epoch 7total_step 1600eta 00:01:25:loss 0.024, acc 1.000
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:01<00:00,  6.92it/s]
2023-04-11 16:25:00 - INFO - current_score 0.7547654781976092█████████████████████████████████████████████████████████████████████████████████████████████████████▊                | 9/10 [00:01<00:00,  6.44it/s]
Training::  65%|████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                       | 145/222 [00:19<00:09,  8.29it/s]2023-04-11 16:25:12 - INFO - Epoch 7total_step 1700eta 00:01:11:loss 0.092, acc 0.938
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:01<00:00,  7.31it/s]
2023-04-11 16:25:13 - INFO - current_score 0.7557815700722958█████████████████████████████████████████████████████████████████████████████████████████████████████▊                | 9/10 [00:01<00:00,  6.79it/s]
Training:: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 222/222 [00:30<00:00,  7.40it/s]
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:01<00:00,  7.42it/s]
Training::  10%|████████████████▋                                                                                                                                                | 23/222 [00:02<00:23,  8.32it/s]2023-04-11 16:25:27 - INFO - Epoch 8total_step 1800eta 00:00:58:loss 0.048, acc 1.000
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:01<00:00,  7.44it/s]
2023-04-11 16:25:28 - INFO - current_score 0.7467869697569813█████████████████████████████████████████████████████████████████████████████████████████████████████▊                | 9/10 [00:01<00:00,  6.93it/s]
Training::  55%|████████████████████████████████████████████████████████████████████████████████████████▋                                                                       | 123/222 [00:16<00:11,  8.73it/s]2023-04-11 16:25:41 - INFO - Epoch 8total_step 1900eta 00:00:44:loss 0.013, acc 1.000
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:01<00:00,  7.10it/s]
2023-04-11 16:25:42 - INFO - current_score 0.7628176530622836█████████████████████████████████████████████████████████████████████████████████████████████████████▊                | 9/10 [00:01<00:00,  6.68it/s]
Training:: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 222/222 [00:29<00:00,  7.43it/s]
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:01<00:00,  7.10it/s]
Training::   0%|▋                                                                                                                                                                 | 1/222 [00:00<00:26,  8.45it/s]2023-04-11 16:25:56 - INFO - Epoch 9total_step 2000eta 00:00:30:loss 0.045, acc 1.000
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:01<00:00,  7.11it/s]
2023-04-11 16:25:57 - INFO - current_score 0.7567767236105911█████████████████████████████████████████████████████████████████████████████████████████████████████▊                | 9/10 [00:01<00:00,  6.62it/s]
Training::  45%|████████████████████████████████████████████████████████████████████████▊                                                                                       | 101/222 [00:13<00:14,  8.08it/s]2023-04-11 16:26:09 - INFO - Epoch 9total_step 2100eta 00:00:16:loss 0.323, acc 0.875
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:01<00:00,  7.01it/s]
2023-04-11 16:26:11 - INFO - current_score 0.7563005241002616█████████████████████████████████████████████████████████████████████████████████████████████████████▊                | 9/10 [00:01<00:00,  6.70it/s]
Training::  91%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊               | 201/222 [00:27<00:02,  8.15it/s]2023-04-11 16:26:23 - INFO - Epoch 9total_step 2200eta 00:00:02:loss 0.171, acc 0.875
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:01<00:00,  7.23it/s]
2023-04-11 16:26:24 - INFO - current_score 0.7601414788413008█████████████████████████████████████████████████████████████████████████████████████████████████████▊                | 9/10 [00:01<00:00,  6.79it/s]
Training:: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 222/222 [00:31<00:00,  7.11it/s]
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:01<00:00,  7.32it/s