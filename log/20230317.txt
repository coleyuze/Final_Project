(base) root@9cf9c6d4615a:~/test20230317/task2# python -m src.train  --bert_seq_length=32   --learning_rate=1e-4 --bert_learning_rate=2e-5 --savedmodel_path='data/checkpoint/0708_ema_4_stance_twitter_emb_freeze' --max_epochs=1  --ema_start=-1   --fgm=0 
The GPUS ids:  0
Some weights of the model checkpoint at roberta-base were not used when initializing RobertaModel: ['lm_head.bias', 'lm_head.layer_norm.bias', 'lm_head.decoder.weight', 'lm_head.dense.bias', 'lm_head.dense.weight', 'lm_head.layer_norm.weight']
- This IS expected if you are initializing RobertaModel from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing RobertaModel from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
The train data length:  222
The valid data length:  10
2023-03-17 00:20:36 - INFO - Training/evaluation parameters: Namespace(adam_epsilon=1e-06, alpha=0, batch_size=16, bert_cache='data/bert_cache/', bert_dir='roberta-base', bert_embedding_size=768, bert_hidden_dropout_prob=0.1, bert_hidden_size=768, bert_learning_rate=2e-05, bert_max_steps=30000, bert_seq_length=32, bert_warmup_steps=5000, best_score=0.75, ckpt_file=None, class_label=3, constant_lr=False, device='cuda', distributed_train=False, dropout=0.3, ema_decay=0.999, ema_start=-1, embedding_freeze=False, fgm=0, gamma=0, gamma_focal=-1, gpu_ids='0', gradient_accumulation_steps=2, learning_rate=0.0001, max_epochs=1, max_grad_norm=1.0, max_steps=222, minimum_lr=0.0, n_gpu=1, pgd=0, premise=False, pretrain_model_path=None, print_steps=100, result_file='result.tsv', save_steps=100, savedmodel_path='data/checkpoint/0708_ema_4_stance_twitter_emb_freeze', seed=42, swa_lr=5e-05, swa_start=-1, test_batch_size=64, test_path='data/validation.tsv', train_path='data/train.tsv', use_rdrop=False, val_batch_size=64, valid_path='data/validation.tsv', warmup_rate=0.1, warmup_steps=22, weight_decay=0.01)
Training::  45%|███████████████████████████████████████████████████████████████████████▊                                                                                         | 99/222 [00:08<00:08, 15.16it/s]2023-03-17 00:20:44 - INFO - Epoch 0total_step 100eta 00:00:10:loss 0.918, acc 0.562
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:00<00:00, 14.61it/s]
2023-03-17 00:20:45 - INFO - current_score 0.5364763989604006█████████████████████████████████████████████████████████████████████████████████████▌                                | 8/10 [00:00<00:00, 13.97it/s]
Training::  89%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                  | 197/222 [00:15<00:01, 16.12it/s]2023-03-17 00:20:52 - INFO - Epoch 0total_step 200eta 00:00:01:loss 1.097, acc 0.562
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:00<00:00, 13.90it/s]
2023-03-17 00:20:52 - INFO - current_score 0.5432566045066045█████████████████████████████████████████████████████████████████████████████████████▌                                | 8/10 [00:00<00:00, 12.19it/s]
Training:: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 222/222 [00:18<00:00, 12.28it/s]
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:00<00:00, 16.32it/s]
(base) root@9cf9c6d4615a:~/test20230317/task2# python -m src.train --gpu_ids='2' --bert_seq_length=128 --learning_rate=1e-4 --bert_learning_rate=5e-5 --savedmodel_path='data/checkpoint/0703_swa_10' --max_epochs=10 --swa_start=5 --swa_lr=2e-5
The GPUS ids:  2
Some weights of the model checkpoint at roberta-base were not used when initializing RobertaModel: ['lm_head.decoder.weight', 'lm_head.dense.weight', 'lm_head.dense.bias', 'lm_head.layer_norm.bias', 'lm_head.layer_norm.weight', 'lm_head.bias']
- This IS expected if you are initializing RobertaModel from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing RobertaModel from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
The train data length:  222
The valid data length:  10
使用SWA！
2023-03-17 00:21:40 - INFO - Training/evaluation parameters: Namespace(adam_epsilon=1e-06, alpha=0, batch_size=16, bert_cache='data/bert_cache/', bert_dir='roberta-base', bert_embedding_size=768, bert_hidden_dropout_prob=0.1, bert_hidden_size=768, bert_learning_rate=5e-05, bert_max_steps=30000, bert_seq_length=128, bert_warmup_steps=5000, best_score=0.75, ckpt_file=None, class_label=3, constant_lr=False, device='cuda', distributed_train=False, dropout=0.3, ema_decay=0.999, ema_start=-1, embedding_freeze=False, fgm=0, gamma=0, gamma_focal=-1, gpu_ids='2', gradient_accumulation_steps=2, learning_rate=0.0001, max_epochs=10, max_grad_norm=1.0, max_steps=2220, minimum_lr=0.0, n_gpu=1, pgd=0, premise=False, pretrain_model_path=None, print_steps=100, result_file='result.tsv', save_steps=100, savedmodel_path='data/checkpoint/0703_swa_10', seed=42, swa_lr=2e-05, swa_start=5, test_batch_size=64, test_path='data/validation.tsv', train_path='data/train.tsv', use_rdrop=False, val_batch_size=64, valid_path='data/validation.tsv', warmup_rate=0.1, warmup_steps=222, weight_decay=0.01)
Training::  45%|███████████████████████████████████████████████████████████████████████▊                                                                                         | 99/222 [00:17<00:18,  6.73it/s]2023-03-17 00:21:57 - INFO - Epoch 0total_step 100eta 00:06:10:loss 0.867, acc 0.688
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:01<00:00,  7.22it/s]
2023-03-17 00:21:58 - INFO - current_score 0.5150191719451848█████████████████████████████████████████████████████████████████████████████████████████████████████▊                | 9/10 [00:01<00:00,  7.74it/s]
Training::  90%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                | 199/222 [00:30<00:02,  8.51it/s]2023-03-17 00:22:10 - INFO - Epoch 0total_step 200eta 00:05:10:loss 0.884, acc 0.562
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:01<00:00,  9.31it/s]
2023-03-17 00:22:11 - INFO - current_score 0.5739709767177132█████████████████████████████████████████████████████████████████████████████████████████████████████▊                | 9/10 [00:01<00:00,  8.75it/s]
Training:: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 222/222 [00:35<00:00,  6.32it/s]
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:01<00:00,  7.24it/s]
Training::  35%|███████████████████████████████████████████████████████▊                                                                                                         | 77/222 [00:12<00:23,  6.24it/s]2023-03-17 00:22:29 - INFO - Epoch 1total_step 300eta 00:05:13:loss 0.508, acc 0.812
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:01<00:00,  7.31it/s]
2023-03-17 00:22:30 - INFO - current_score 0.6394818504682576█████████████████████████████████████████████████████████████████████████████████████████████████████▊                | 9/10 [00:01<00:00,  7.51it/s]
Training::  80%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                | 177/222 [00:30<00:06,  6.85it/s]2023-03-17 00:22:46 - INFO - Epoch 1total_step 400eta 00:05:03:loss 0.718, acc 0.750
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:01<00:00,  7.25it/s]
2023-03-17 00:22:48 - INFO - current_score 0.6727307091065895█████████████████████████████████████████████████████████████████████████████████████████████████████▊                | 9/10 [00:01<00:00,  7.86it/s]
Training:: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 222/222 [00:38<00:00,  5.72it/s]
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:01<00:00,  7.11it/s]
Training::  25%|███████████████████████████████████████▉                                                                                                                         | 55/222 [00:09<00:25,  6.66it/s]2023-03-17 00:23:06 - INFO - Epoch 2total_step 500eta 00:04:56:loss 0.478, acc 0.812
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:01<00:00,  7.26it/s]
2023-03-17 00:23:07 - INFO - current_score 0.6916353711156871█████████████████████████████████████████████████████████████████████████████████████████████████████▊                | 9/10 [00:01<00:00,  7.83it/s]
Training::  70%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                | 155/222 [00:27<00:12,  5.31it/s]2023-03-17 00:23:24 - INFO - Epoch 2total_step 600eta 00:04:41:loss 0.531, acc 0.812
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:01<00:00,  7.23it/s]
2023-03-17 00:23:25 - INFO - current_score 0.7042396176256935█████████████████████████████████████████████████████████████████████████████████████████████████████▊                | 9/10 [00:01<00:00,  7.05it/s]
Training:: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 222/222 [00:39<00:00,  5.60it/s]
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:01<00:00,  7.21it/s]
Training::  15%|███████████████████████▉                                                                                                                                         | 33/222 [00:05<00:36,  5.23it/s]2023-03-17 00:23:43 - INFO - Epoch 3total_step 700eta 00:04:28:loss 0.413, acc 0.875
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:01<00:00,  7.29it/s]
2023-03-17 00:23:44 - INFO - current_score 0.7250502352099383█████████████████████████████████████████████████████████████████████████████████████████████████████▊                | 9/10 [00:01<00:00,  5.70it/s]
Training::  60%|███████████████████████████████████████████████████████████████████████████████████████████████▊                                                                | 133/222 [00:23<00:13,  6.72it/s]2023-03-17 00:24:01 - INFO - Epoch 3total_step 800eta 00:04:10:loss 0.482, acc 0.812
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:01<00:00,  7.25it/s]
2023-03-17 00:24:02 - INFO - current_score 0.7305266321486266█████████████████████████████████████████████████████████████████████████████████████████████████████▊                | 9/10 [00:01<00:00,  7.75it/s]
Training:: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 222/222 [00:38<00:00,  5.71it/s]
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:01<00:00,  9.30it/s]
Training::   5%|███████▉                                                                                                                                                         | 11/222 [00:01<00:24,  8.62it/s]2023-03-17 00:24:19 - INFO - Epoch 4total_step 900eta 00:03:53:loss 0.479, acc 0.875
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:01<00:00,  9.29it/s]
2023-03-17 00:24:22 - INFO - best_score 0.7511504480800684████████████████████████████████████████████████████████████████████████████████████████████████████████▊                | 9/10 [00:01<00:00,  8.66it/s]
2023-03-17 00:24:22 - INFO - current_score 0.7511504480800684
Training::  50%|████████████████████████████████████████████████████████████████████████████████                                                                                | 111/222 [00:18<00:23,  4.75it/s]2023-03-17 00:24:36 - INFO - Epoch 4total_step 1000eta 00:03:35:loss 0.202, acc 0.938
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:01<00:00,  7.20it/s]
2023-03-17 00:24:40 - INFO - best_score 0.7516314163822375████████████████████████████████████████████████████████████████████████████████████████████████████████▊                | 9/10 [00:01<00:00,  6.05it/s]
2023-03-17 00:24:40 - INFO - current_score 0.7516314163822375
Training::  95%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████        | 211/222 [00:39<00:02,  4.96it/s]2023-03-17 00:24:57 - INFO - Epoch 4total_step 1100eta 00:03:20:loss 0.148, acc 0.938
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:01<00:00,  7.26it/s]
2023-03-17 00:25:01 - INFO - best_score 0.7606739742154076████████████████████████████████████████████████████████████████████████████████████████████████████████▊                | 9/10 [00:01<00:00,  6.35it/s]
2023-03-17 00:25:01 - INFO - current_score 0.7606739742154076
Training:: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 222/222 [00:45<00:00,  4.91it/s]
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:01<00:00,  7.34it/s]
Training::  40%|████████████████████████████████████████████████████████████████▌                                                                                                | 89/222 [00:14<00:17,  7.53it/s]2023-03-17 00:25:19 - INFO - Epoch 5total_step 1200eta 00:03:06:loss 0.164, acc 1.000
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:01<00:00,  8.17it/s]
2023-03-17 00:25:23 - INFO - best_score 0.7642152164775116████████████████████████████████████████████████████████████████████████████████████████████████████████▊                | 9/10 [00:01<00:00,  8.19it/s]
2023-03-17 00:25:23 - INFO - current_score 0.7642152164775116
Training::  85%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                       | 189/222 [00:35<00:06,  5.19it/s]2023-03-17 00:25:39 - INFO - Epoch 5total_step 1300eta 00:02:49:loss 0.184, acc 0.875
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:01<00:00,  7.27it/s]
2023-03-17 00:25:44 - INFO - best_score 0.7661823480907692████████████████████████████████████████████████████████████████████████████████████████████████████████▊                | 9/10 [00:01<00:00,  5.75it/s]
2023-03-17 00:25:44 - INFO - current_score 0.7661823480907692
Training:: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 222/222 [00:44<00:00,  4.97it/s]
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:01<00:00,  7.24it/s]
2023-03-17 00:25:53 - INFO - best_score 0.7677863577863577
Training::  30%|████████████████████████████████████████████████▌                                                                                                                | 67/222 [00:11<00:28,  5.45it/s]2023-03-17 00:26:04 - INFO - Epoch 6total_step 1400eta 00:02:34:loss 0.106, acc 1.000
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:01<00:00,  7.25it/s]
2023-03-17 00:26:08 - INFO - best_score 0.7711014905544633████████████████████████████████████████████████████████████████████████████████████████████████████████▊                | 9/10 [00:01<00:00,  6.88it/s]
2023-03-17 00:26:08 - INFO - current_score 0.7711014905544633
Training::  75%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                       | 167/222 [00:31<00:08,  6.12it/s]2023-03-17 00:26:25 - INFO - Epoch 6total_step 1500eta 00:02:16:loss 0.050, acc 1.000
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:01<00:00,  7.11it/s]
2023-03-17 00:26:26 - INFO - current_score 0.7673204422097379█████████████████████████████████████████████████████████████████████████████████████████████████████▊                | 9/10 [00:01<00:00,  6.94it/s]
Training:: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 222/222 [00:40<00:00,  5.42it/s]
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:01<00:00,  9.16it/s]
Training::  20%|████████████████████████████████▋                                                                                                                                | 45/222 [00:05<00:21,  8.23it/s]2023-03-17 00:26:40 - INFO - Epoch 7total_step 1600eta 00:01:56:loss 0.042, acc 1.000
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:01<00:00,  9.02it/s]
2023-03-17 00:26:41 - INFO - current_score 0.7690893029834596█████████████████████████████████████████████████████████████████████████████████████████████████████▊                | 9/10 [00:01<00:00,  8.33it/s]
Training::  65%|████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                       | 145/222 [00:21<00:10,  7.34it/s]2023-03-17 00:26:56 - INFO - Epoch 7total_step 1700eta 00:01:36:loss 0.145, acc 0.938
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:01<00:00,  6.94it/s]
2023-03-17 00:26:58 - INFO - current_score 0.7657369655266851█████████████████████████████████████████████████████████████████████████████████████████████████████▊                | 9/10 [00:01<00:00,  7.77it/s]
Training:: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 222/222 [00:35<00:00,  6.30it/s]
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:01<00:00,  7.24it/s]
Training::  10%|████████████████▋                                                                                                                                                | 23/222 [00:03<00:27,  7.14it/s]2023-03-17 00:27:15 - INFO - Epoch 8total_step 1800eta 00:01:18:loss 0.062, acc 1.000
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:01<00:00,  7.25it/s]
2023-03-17 00:27:17 - INFO - current_score 0.7638531558927744█████████████████████████████████████████████████████████████████████████████████████████████████████▊                | 9/10 [00:01<00:00,  7.92it/s]
Training::  55%|████████████████████████████████████████████████████████████████████████████████████████▋                                                                       | 123/222 [00:21<00:18,  5.47it/s]2023-03-17 00:27:33 - INFO - Epoch 8total_step 1900eta 00:00:59:loss 0.015, acc 1.000
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:01<00:00,  7.33it/s]
2023-03-17 00:27:35 - INFO - current_score 0.7641995389094035█████████████████████████████████████████████████████████████████████████████████████████████████████▊                | 9/10 [00:01<00:00,  6.85it/s]
Training:: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 222/222 [00:39<00:00,  5.63it/s]
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:01<00:00,  7.07it/s]
Training::   0%|▋                                                                                                                                                                 | 1/222 [00:00<00:51,  4.29it/s]2023-03-17 00:27:53 - INFO - Epoch 9total_step 2000eta 00:00:41:loss 0.017, acc 1.000
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:01<00:00,  7.20it/s]
2023-03-17 00:27:54 - INFO - current_score 0.7573566897072628█████████████████████████████████████████████████████████████████████████████████████████████████████▊                | 9/10 [00:01<00:00,  5.85it/s]
Training::  45%|████████████████████████████████████████████████████████████████████████▊                                                                                       | 101/222 [00:18<00:22,  5.44it/s]2023-03-17 00:28:11 - INFO - Epoch 9total_step 2100eta 00:00:22:loss 0.460, acc 0.812
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:01<00:00,  7.29it/s]
2023-03-17 00:28:12 - INFO - current_score 0.7605914627336902█████████████████████████████████████████████████████████████████████████████████████████████████████▊                | 9/10 [00:01<00:00,  7.02it/s]
Training::  91%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊               | 201/222 [00:35<00:02,  7.47it/s]2023-03-17 00:28:28 - INFO - Epoch 9total_step 2200eta 00:00:03:loss 0.230, acc 0.938
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:01<00:00,  7.03it/s]
2023-03-17 00:28:30 - INFO - current_score 0.7605121658776224█████████████████████████████████████████████████████████████████████████████████████████████████████▊                | 9/10 [00:01<00:00,  7.28it/s]
Training:: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 222/222 [00:40<00:00,  5.46it/s]
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:01<00:00,  7.28it/s]