root@9cf9c6d4615a:~/test20230317base/task2# python -m src.train --gpu_ids='2' --bert_seq_length=128 --learning_rate=1e-4 --bert_learning_rate=5e-5 --savedmodel_path='data/checkpoint/0703_swa_10' --max_epochs=10  --adam_epsilon=1e-6 --weight_decay=0.01 --test_batch_size=64 --val_batch_size=64 --batch_size=16
The GPUS ids:  2
Some weights of the model checkpoint at roberta-base were not used when initializing RobertaModel: ['lm_head.dense.bias', 'lm_head.layer_norm.bias', 'lm_head.layer_norm.weight', 'lm_head.decoder.weight', 'lm_head.bias', 'lm_head.dense.weight']
- This IS expected if you are initializing RobertaModel from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing RobertaModel from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
The train data length:  222
The valid data length:  10
2023-04-10 16:59:30 - INFO - Training/evaluation parameters: Namespace(adam_epsilon=1e-06, alpha=0, batch_size=16, bert_cache='data/bert_cache/', bert_dir='roberta-base', bert_embedding_size=768, bert_hidden_dropout_prob=0.1, bert_hidden_size=768, bert_learning_rate=5e-05, bert_max_steps=30000, bert_seq_length=128, bert_warmup_steps=5000, best_score=0.75, ckpt_file=None, class_label=3, constant_lr=False, device='cuda', distributed_train=False, dropout=0.3, ema_decay=0.999, ema_start=-1, embedding_freeze=False, fgm=0, gamma=0, gamma_focal=-1, gpu_ids='2', gradient_accumulation_steps=2, learning_rate=0.0001, max_epochs=10, max_grad_norm=1.0, max_steps=2220, minimum_lr=0.0, n_gpu=1, pgd=0, premise=False, pretrain_model_path=None, print_steps=100, result_file='result.tsv', save_steps=100, savedmodel_path='data/checkpoint/0703_swa_10', seed=42, swa_lr=5e-05, swa_start=-1, test_batch_size=64, test_path='data/validation.tsv', train_path='data/train.tsv', use_rdrop=False, val_batch_size=64, valid_path='data/validation.tsv', warmup_rate=0.1, warmup_steps=222, weight_decay=0.01)
Training::  45%|███████████████████████████████████████████████████████████████████████▊                                                                                         | 99/222 [00:10<00:11, 10.81it/s]2023-04-10 16:59:41 - INFO - Epoch 0total_step 100eta 00:03:43:loss 0.985, acc 0.562
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:01<00:00,  9.36it/s]
2023-04-10 16:59:42 - INFO - current_score 0.5859640199529463█████████████████████████████████████████████████████████████████████████████████████████████████████▊                | 9/10 [00:01<00:00,  8.84it/s]
Training::  90%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                | 199/222 [00:20<00:02, 10.81it/s]2023-04-10 16:59:51 - INFO - Epoch 0total_step 200eta 00:03:30:loss 0.909, acc 0.500
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:01<00:00,  9.56it/s]
2023-04-10 16:59:52 - INFO - current_score 0.5447295413373012█████████████████████████████████████████████████████████████████████████████████████████████████████▊                | 9/10 [00:01<00:00,  9.01it/s]
Training:: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 222/222 [00:23<00:00,  9.26it/s]
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:01<00:00,  9.58it/s]
Training::  34%|███████████████████████████████████████████████████████                                                                                                          | 76/222 [00:07<00:13, 10.74it/s]2023-04-10 17:00:03 - INFO - Epoch 1total_step 300eta 00:03:26:loss 0.778, acc 0.625
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:01<00:00,  9.49it/s]
2023-04-10 17:00:04 - INFO - current_score 0.6295154586224854█████████████████████████████████████████████████████████████████████████████████████████████████████▊                | 9/10 [00:01<00:00,  8.93it/s]
Training::  79%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                 | 176/222 [00:17<00:04, 10.41it/s]2023-04-10 17:00:13 - INFO - Epoch 1total_step 400eta 00:03:14:loss 0.981, acc 0.562
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:01<00:00,  9.40it/s]
2023-04-10 17:00:14 - INFO - current_score 0.6624093254908905█████████████████████████████████████████████████████████████████████████████████████████████████████▊                | 9/10 [00:01<00:00,  8.91it/s]
Training:: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 222/222 [00:22<00:00,  9.67it/s]
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:01<00:00,  9.50it/s]
Training::  24%|███████████████████████████████████████▏                                                                                                                         | 54/222 [00:05<00:15, 10.70it/s]2023-04-10 17:00:25 - INFO - Epoch 2total_step 500eta 00:03:06:loss 0.637, acc 0.812
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:01<00:00,  9.47it/s]
2023-04-10 17:00:26 - INFO - current_score 0.694428576179943██████████████████████████████████████████████████████████████████████████████████████████████████████▊                | 9/10 [00:01<00:00,  8.91it/s]
Training::  69%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                 | 154/222 [00:15<00:06, 10.69it/s]2023-04-10 17:00:35 - INFO - Epoch 2total_step 600eta 00:02:54:loss 0.685, acc 0.750
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:01<00:00,  9.47it/s]
2023-04-10 17:00:36 - INFO - current_score 0.6800525333538249█████████████████████████████████████████████████████████████████████████████████████████████████████▊                | 9/10 [00:01<00:00,  8.91it/s]
Training:: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 222/222 [00:22<00:00,  9.70it/s]
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:01<00:00,  9.46it/s]
Training::  14%|███████████████████████▏                                                                                                                                         | 32/222 [00:02<00:17, 10.71it/s]2023-04-10 17:00:46 - INFO - Epoch 3total_step 700eta 00:02:45:loss 0.794, acc 0.688
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:01<00:00,  9.47it/s]
2023-04-10 17:00:48 - INFO - current_score 0.6969480002914594█████████████████████████████████████████████████████████████████████████████████████████████████████▊                | 9/10 [00:01<00:00,  8.89it/s]
Training::  59%|███████████████████████████████████████████████████████████████████████████████████████████████▏                                                                | 132/222 [00:13<00:08, 10.34it/s]2023-04-10 17:00:57 - INFO - Epoch 3total_step 800eta 00:02:33:loss 0.637, acc 0.812
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:01<00:00,  9.23it/s]
2023-04-10 17:00:58 - INFO - current_score 0.6893697513281072█████████████████████████████████████████████████████████████████████████████████████████████████████▊                | 9/10 [00:01<00:00,  8.73it/s]
Training:: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 222/222 [00:23<00:00,  9.57it/s]
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:01<00:00,  9.43it/s]
Training::   5%|███████▎                                                                                                                                                         | 10/222 [00:00<00:19, 10.66it/s]2023-04-10 17:01:09 - INFO - Epoch 4total_step 900eta 00:02:24:loss 0.226, acc 0.938
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:01<00:00,  9.19it/s]
2023-04-10 17:01:10 - INFO - current_score 0.6781229014260128█████████████████████████████████████████████████████████████████████████████████████████████████████▊                | 9/10 [00:01<00:00,  8.47it/s]
Training::  50%|███████████████████████████████████████████████████████████████████████████████▎                                                                                | 110/222 [00:11<00:10, 10.68it/s]2023-04-10 17:01:19 - INFO - Epoch 4total_step 1000eta 00:02:12:loss 0.345, acc 0.875
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:01<00:00,  9.43it/s]
2023-04-10 17:01:20 - INFO - current_score 0.7215246810535176█████████████████████████████████████████████████████████████████████████████████████████████████████▊                | 9/10 [00:01<00:00,  8.80it/s]
Training::  95%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎        | 210/222 [00:21<00:01, 10.68it/s]2023-04-10 17:01:30 - INFO - Epoch 4total_step 1100eta 00:02:01:loss 0.153, acc 0.938
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:01<00:00,  9.43it/s]
2023-04-10 17:01:31 - INFO - current_score 0.7062298025283535█████████████████████████████████████████████████████████████████████████████████████████████████████▊                | 9/10 [00:01<00:00,  8.87it/s]
Training:: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 222/222 [00:24<00:00,  9.23it/s]
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:01<00:00,  9.46it/s]
Training::  40%|███████████████████████████████████████████████████████████████▊                                                                                                 | 88/222 [00:08<00:12, 10.68it/s]2023-04-10 17:01:41 - INFO - Epoch 5total_step 1200eta 00:01:51:loss 0.067, acc 1.000
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:01<00:00,  9.45it/s]
2023-04-10 17:01:42 - INFO - current_score 0.722626443647949██████████████████████████████████████████████████████████████████████████████████████████████████████▊                | 9/10 [00:01<00:00,  8.88it/s]
Training::  85%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                        | 188/222 [00:18<00:03, 10.36it/s]2023-04-10 17:01:52 - INFO - Epoch 5total_step 1300eta 00:01:40:loss 0.041, acc 1.000
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:01<00:00,  9.19it/s]
2023-04-10 17:01:53 - INFO - current_score 0.7384784757153178█████████████████████████████████████████████████████████████████████████████████████████████████████▊                | 9/10 [00:01<00:00,  8.75it/s]
Training:: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 222/222 [00:23<00:00,  9.59it/s]
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:01<00:00,  8.95it/s]
Training::  30%|███████████████████████████████████████████████▊                                                                                                                 | 66/222 [00:06<00:14, 10.41it/s]2023-04-10 17:02:03 - INFO - Epoch 6total_step 1400eta 00:01:29:loss 0.027, acc 1.000
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:01<00:00,  9.20it/s]
2023-04-10 17:02:04 - INFO - current_score 0.7354746427281639█████████████████████████████████████████████████████████████████████████████████████████████████████▊                | 9/10 [00:01<00:00,  8.73it/s]
Training::  75%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                        | 166/222 [00:16<00:05, 10.64it/s]2023-04-10 17:02:14 - INFO - Epoch 6total_step 1500eta 00:01:18:loss 0.053, acc 1.000
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:01<00:00,  9.30it/s]
2023-04-10 17:02:15 - INFO - current_score 0.7302616276230727█████████████████████████████████████████████████████████████████████████████████████████████████████▊                | 9/10 [00:01<00:00,  8.69it/s]
Training:: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 222/222 [00:23<00:00,  9.60it/s]
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:01<00:00,  9.41it/s]
Training::  20%|███████████████████████████████▉                                                                                                                                 | 44/222 [00:04<00:16, 10.60it/s]2023-04-10 17:02:25 - INFO - Epoch 7total_step 1600eta 00:01:07:loss 0.008, acc 1.000
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:01<00:00,  9.40it/s]
2023-04-10 17:02:27 - INFO - current_score 0.7455218715971403█████████████████████████████████████████████████████████████████████████████████████████████████████▊                | 9/10 [00:01<00:00,  8.82it/s]
Training::  65%|███████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                        | 144/222 [00:14<00:07, 10.60it/s]2023-04-10 17:02:36 - INFO - Epoch 7total_step 1700eta 00:00:56:loss 0.098, acc 0.938
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:01<00:00,  9.37it/s]
2023-04-10 17:02:37 - INFO - current_score 0.7487447245379754█████████████████████████████████████████████████████████████████████████████████████████████████████▊                | 9/10 [00:01<00:00,  8.80it/s]
Training:: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 222/222 [00:23<00:00,  9.60it/s]
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:01<00:00,  9.38it/s]
Training::  10%|███████████████▉                                                                                                                                                 | 22/222 [00:02<00:19, 10.47it/s]2023-04-10 17:02:48 - INFO - Epoch 8total_step 1800eta 00:00:46:loss 0.027, acc 1.000
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:01<00:00,  9.17it/s]
2023-04-10 17:02:49 - INFO - current_score 0.7479572145954907█████████████████████████████████████████████████████████████████████████████████████████████████████▊                | 9/10 [00:01<00:00,  8.74it/s]
Training::  55%|███████████████████████████████████████████████████████████████████████████████████████▉                                                                        | 122/222 [00:12<00:09, 10.59it/s]2023-04-10 17:02:58 - INFO - Epoch 8total_step 1900eta 00:00:34:loss 0.002, acc 1.000
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:01<00:00,  9.38it/s]
2023-04-10 17:02:59 - INFO - current_score 0.7439640895422192█████████████████████████████████████████████████████████████████████████████████████████████████████▊                | 9/10 [00:01<00:00,  8.80it/s]
Training:: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 222/222 [00:23<00:00,  9.60it/s]
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:01<00:00,  9.38it/s]
Training::   0%|                                                                                                                                                                          | 0/222 [00:00<?, ?it/s]2023-04-10 17:03:10 - INFO - Epoch 9total_step 2000eta 00:00:24:loss 0.043, acc 1.000
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:01<00:00,  9.39it/s]
2023-04-10 17:03:11 - INFO - current_score 0.736946717546578██████████████████████████████████████████████████████████████████████████████████████████████████████▊                | 9/10 [00:01<00:00,  8.82it/s]
Training::  45%|████████████████████████████████████████████████████████████████████████                                                                                        | 100/222 [00:10<00:11, 10.28it/s]2023-04-10 17:03:20 - INFO - Epoch 9total_step 2100eta 00:00:13:loss 0.241, acc 0.875
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:01<00:00,  9.09it/s]
2023-04-10 17:03:21 - INFO - current_score 0.7384939087324369█████████████████████████████████████████████████████████████████████████████████████████████████████▊                | 9/10 [00:01<00:00,  8.45it/s]
Training::  90%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏               | 200/222 [00:21<00:02, 10.35it/s]2023-04-10 17:03:31 - INFO - Epoch 9total_step 2200eta 00:00:02:loss 0.179, acc 0.875
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:01<00:00,  9.13it/s]
2023-04-10 17:03:32 - INFO - current_score 0.7399885591285176█████████████████████████████████████████████████████████████████████████████████████████████████████▊                | 9/10 [00:01<00:00,  8.70it/s]
Training:: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 222/222 [00:24<00:00,  9.06it/s]
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:01<00:00,  9.38it/s