root@9cf9c6d4615a:~/test20230317base/task2# python -m src.train --gpu_ids='2' --bert_seq_length=128 --learning_rate=1e-4 --bert_learning_rate=5e-5 --savedmodel_path='data/checkpoint/0703_swa_10' --max_epochs=10  --adam_epsilon=1e-6 --weight_decay=0.01 --test_batch_size=64 --val_batch_size=64 --batch_size=16 --swa_start=5 --swa_lr=1e-4
addle !!!!!!!!!!!!!!!!!!!!!!!!!!!!
The GPUS ids:  2
Some weights of the model checkpoint at roberta-base were not used when initializing RobertaModel: ['lm_head.dense.bias', 'lm_head.layer_norm.weight', 'lm_head.bias', 'lm_head.decoder.weight', 'lm_head.layer_norm.bias', 'lm_head.dense.weight']
- This IS expected if you are initializing RobertaModel from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing RobertaModel from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
The train data length:  222
The valid data length:  10
使用SWA！
2023-04-11 18:34:15 - INFO - Training/evaluation parameters: Namespace(adam_epsilon=1e-06, alpha=0, batch_size=16, bert_cache='data/bert_cache/', bert_dir='roberta-base', bert_embedding_size=768, bert_hidden_dropout_prob=0.1, bert_hidden_size=768, bert_learning_rate=5e-05, bert_max_steps=30000, bert_seq_length=128, bert_warmup_steps=5000, best_score=0.75, ckpt_file=None, class_label=3, constant_lr=False, device='cuda', distributed_train=False, dropout=0.3, ema_decay=0.999, ema_start=-1, embedding_freeze=False, fgm=0, gamma=0, gamma_focal=-1, gpu_ids='2', gradient_accumulation_steps=2, learning_rate=0.0001, max_epochs=10, max_grad_norm=1.0, max_steps=2220, minimum_lr=0.0, n_gpu=1, pgd=0, premise=False, pretrain_model_path=None, print_steps=100, result_file='result.tsv', save_steps=100, savedmodel_path='data/checkpoint/0703_swa_10', seed=42, swa_lr=0.0001, swa_start=5, test_batch_size=64, test_path='data/validation.tsv', train_path='data/train.tsv', use_rdrop=False, val_batch_size=64, valid_path='data/validation.tsv', warmup_rate=0.1, warmup_steps=222, weight_decay=0.01)
Training::  45%|███████████████████████████████████████████████████████████████████████▊                                                                                         | 99/222 [00:23<00:27,  4.55it/s]2023-04-11 18:34:39 - INFO - Epoch 0total_step 100eta 00:08:15:loss 1.066, acc 0.250
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:01<00:00,  7.32it/s]
2023-04-11 18:34:40 - INFO - current_score 0.3379363460487025█████████████████████████████████████████████████████████████████████████████████████████████████████▊                | 9/10 [00:01<00:00,  6.96it/s]
Training::  90%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                | 199/222 [00:45<00:04,  5.01it/s]2023-04-11 18:35:01 - INFO - Epoch 0total_step 200eta 00:07:44:loss 1.083, acc 0.312
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:01<00:00,  7.37it/s]
2023-04-11 18:35:03 - INFO - current_score 0.3665211918979042█████████████████████████████████████████████████████████████████████████████████████████████████████▊                | 9/10 [00:01<00:00,  6.99it/s]
Training:: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 222/222 [00:52<00:00,  4.26it/s]
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:01<00:00,  7.51it/s]
Training::  35%|███████████████████████████████████████████████████████▊                                                                                                         | 77/222 [00:16<00:31,  4.54it/s]2023-04-11 18:35:26 - INFO - Epoch 1total_step 300eta 00:07:30:loss 0.979, acc 0.500
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:01<00:00,  7.47it/s]
2023-04-11 18:35:27 - INFO - current_score 0.3677858293075684█████████████████████████████████████████████████████████████████████████████████████████████████████▊                | 9/10 [00:01<00:00,  7.06it/s]
Training::  80%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                | 177/222 [00:40<00:09,  4.63it/s]2023-04-11 18:35:49 - INFO - Epoch 1total_step 400eta 00:07:06:loss 1.032, acc 0.500
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:01<00:00,  7.17it/s]
2023-04-11 18:35:50 - INFO - current_score 0.3641498783648348█████████████████████████████████████████████████████████████████████████████████████████████████████▊                | 9/10 [00:01<00:00,  6.61it/s]
Training:: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 222/222 [00:51<00:00,  4.34it/s]
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:01<00:00,  7.40it/s]
Training::  25%|███████████████████████████████████████▉                                                                                                                         | 55/222 [00:12<00:38,  4.29it/s]2023-04-11 18:36:14 - INFO - Epoch 2total_step 500eta 00:06:47:loss 1.076, acc 0.562
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:01<00:00,  7.12it/s]
2023-04-11 18:36:15 - INFO - current_score 0.37410592257552955████████████████████████████████████████████████████████████████████████████████████████████████████▊                | 9/10 [00:01<00:00,  6.74it/s]
Training::  70%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                | 155/222 [00:35<00:14,  4.48it/s]2023-04-11 18:36:37 - INFO - Epoch 2total_step 600eta 00:06:22:loss 1.084, acc 0.375
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:01<00:00,  7.15it/s]
2023-04-11 18:36:38 - INFO - current_score 0.36477550144145243████████████████████████████████████████████████████████████████████████████████████████████████████▊                | 9/10 [00:01<00:00,  6.66it/s]
Training:: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 222/222 [00:51<00:00,  4.33it/s]
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:01<00:00,  7.52it/s]
Training::  15%|███████████████████████▉                                                                                                                                         | 33/222 [00:07<00:41,  4.61it/s]2023-04-11 18:37:01 - INFO - Epoch 3total_step 700eta 00:06:00:loss 1.091, acc 0.562
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:01<00:00,  7.42it/s]
2023-04-11 18:37:03 - INFO - current_score 0.37410592257552955████████████████████████████████████████████████████████████████████████████████████████████████████▊                | 9/10 [00:01<00:00,  6.87it/s]
Training::  60%|███████████████████████████████████████████████████████████████████████████████████████████████▊                                                                | 133/222 [00:30<00:19,  4.65it/s]2023-04-11 18:37:25 - INFO - Epoch 3total_step 800eta 00:05:35:loss 1.069, acc 0.438
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:01<00:00,  7.55it/s]
2023-04-11 18:37:26 - INFO - current_score 0.36945972296933827████████████████████████████████████████████████████████████████████████████████████████████████████▊                | 9/10 [00:01<00:00,  7.23it/s]
Training:: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 222/222 [00:51<00:00,  4.35it/s]
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:01<00:00,  7.34it/s]
Training::   5%|███████▉                                                                                                                                                         | 11/222 [00:02<00:44,  4.70it/s]2023-04-11 18:37:49 - INFO - Epoch 4total_step 900eta 00:05:13:loss 1.092, acc 0.438
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:01<00:00,  7.45it/s]
2023-04-11 18:37:50 - INFO - current_score 0.36841942945000805████████████████████████████████████████████████████████████████████████████████████████████████████▊                | 9/10 [00:01<00:00,  6.90it/s]
Training::  50%|████████████████████████████████████████████████████████████████████████████████                                                                                | 111/222 [00:25<00:23,  4.67it/s]2023-04-11 18:38:12 - INFO - Epoch 4total_step 1000eta 00:04:48:loss 1.086, acc 0.375
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:01<00:00,  7.35it/s]
2023-04-11 18:38:13 - INFO - current_score 0.3634735192922094█████████████████████████████████████████████████████████████████████████████████████████████████████▊                | 9/10 [00:01<00:00,  6.80it/s]
Training::  95%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████        | 211/222 [00:45<00:01,  7.98it/s]2023-04-11 18:38:32 - INFO - Epoch 4total_step 1100eta 00:04:21:loss 1.002, acc 0.625
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:01<00:00,  8.65it/s]
2023-04-11 18:38:33 - INFO - current_score 0.3634735192922094█████████████████████████████████████████████████████████████████████████████████████████████████████▊                | 9/10 [00:01<00:00,  8.13it/s]
Training:: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 222/222 [00:47<00:00,  4.64it/s]
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:01<00:00,  8.60it/s]
Training::  40%|████████████████████████████████████████████████████████████████▌                                                                                                | 89/222 [00:11<00:19,  6.85it/s]2023-04-11 18:38:47 - INFO - Epoch 5total_step 1200eta 00:03:50:loss 1.009, acc 0.438
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:01<00:00,  7.66it/s]
2023-04-11 18:38:48 - INFO - current_score 0.3633644003538481█████████████████████████████████████████████████████████████████████████████████████████████████████▊                | 9/10 [00:01<00:00,  7.21it/s]
Training::  85%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                       | 189/222 [00:27<00:07,  4.46it/s]2023-04-11 18:39:03 - INFO - Epoch 5total_step 1300eta 00:03:23:loss 1.045, acc 0.375
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:01<00:00,  7.51it/s]
2023-04-11 18:39:04 - INFO - current_score 0.3600731712088901█████████████████████████████████████████████████████████████████████████████████████████████████████▊                | 9/10 [00:01<00:00,  7.07it/s]
Training:: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 222/222 [00:36<00:00,  6.13it/s]
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:01<00:00,  7.11it/s]
Training::  30%|████████████████████████████████████████████████▌                                                                                                                | 67/222 [00:14<00:34,  4.46it/s]2023-04-11 18:39:28 - INFO - Epoch 6total_step 1400eta 00:03:02:loss 1.056, acc 0.312
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:01<00:00,  7.39it/s]
2023-04-11 18:39:29 - INFO - current_score 0.36219844060541195████████████████████████████████████████████████████████████████████████████████████████████████████▊                | 9/10 [00:01<00:00,  6.98it/s]
Training::  75%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                       | 167/222 [00:37<00:12,  4.39it/s]2023-04-11 18:39:51 - INFO - Epoch 6total_step 1500eta 00:02:41:loss 1.111, acc 0.312
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:01<00:00,  7.26it/s]
2023-04-11 18:39:52 - INFO - current_score 0.3600731712088901█████████████████████████████████████████████████████████████████████████████████████████████████████▊                | 9/10 [00:01<00:00,  6.85it/s]
Training:: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 222/222 [00:51<00:00,  4.32it/s]
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:01<00:00,  7.54it/s]
Training::  20%|████████████████████████████████▋                                                                                                                                | 45/222 [00:09<00:39,  4.45it/s]2023-04-11 18:40:16 - INFO - Epoch 7total_step 1600eta 00:02:19:loss 1.068, acc 0.500
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:01<00:00,  7.27it/s]
2023-04-11 18:40:17 - INFO - current_score 0.3660784803277024█████████████████████████████████████████████████████████████████████████████████████████████████████▊                | 9/10 [00:01<00:00,  6.64it/s]
Training::  65%|████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                       | 145/222 [00:33<00:16,  4.60it/s]2023-04-11 18:40:40 - INFO - Epoch 7total_step 1700eta 00:01:57:loss 1.032, acc 0.500
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:01<00:00,  7.44it/s]
2023-04-11 18:40:41 - INFO - current_score 0.36219844060541195████████████████████████████████████████████████████████████████████████████████████████████████████▊                | 9/10 [00:01<00:00,  7.02it/s]
Training:: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 222/222 [00:51<00:00,  4.30it/s]
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:01<00:00,  7.27it/s]
Training::  10%|████████████████▋                                                                                                                                                | 23/222 [00:05<00:43,  4.55it/s]2023-04-11 18:41:04 - INFO - Epoch 8total_step 1800eta 00:01:35:loss 1.063, acc 0.375
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:01<00:00,  7.21it/s]
2023-04-11 18:41:06 - INFO - current_score 0.3660784803277024█████████████████████████████████████████████████████████████████████████████████████████████████████▊                | 9/10 [00:01<00:00,  6.84it/s]
Training::  55%|████████████████████████████████████████████████████████████████████████████████████████▋                                                                       | 123/222 [00:28<00:21,  4.57it/s]2023-04-11 18:41:27 - INFO - Epoch 8total_step 1900eta 00:01:12:loss 1.077, acc 0.438
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:01<00:00,  7.45it/s]
2023-04-11 18:41:29 - INFO - current_score 0.3607524549528077█████████████████████████████████████████████████████████████████████████████████████████████████████▊                | 9/10 [00:01<00:00,  6.97it/s]
Training:: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 222/222 [00:50<00:00,  4.35it/s]
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:01<00:00,  7.21it/s]
Training::   0%|▋                                                                                                                                                                 | 1/222 [00:00<00:49,  4.43it/s]2023-04-11 18:41:52 - INFO - Epoch 9total_step 2000eta 00:00:50:loss 1.107, acc 0.438
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:01<00:00,  7.72it/s]
2023-04-11 18:41:53 - INFO - current_score 0.3607524549528077█████████████████████████████████████████████████████████████████████████████████████████████████████▊                | 9/10 [00:01<00:00,  7.22it/s]
Training::  45%|████████████████████████████████████████████████████████████████████████▊                                                                                       | 101/222 [00:23<00:26,  4.56it/s]2023-04-11 18:42:15 - INFO - Epoch 9total_step 2100eta 00:00:27:loss 1.086, acc 0.250
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:01<00:00,  7.24it/s]
2023-04-11 18:42:16 - INFO - current_score 0.3600731712088901█████████████████████████████████████████████████████████████████████████████████████████████████████▊                | 9/10 [00:01<00:00,  6.77it/s]
Training::  91%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊               | 201/222 [00:46<00:04,  4.55it/s]2023-04-11 18:42:38 - INFO - Epoch 9total_step 2200eta 00:00:04:loss 1.072, acc 0.438
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:01<00:00,  7.06it/s]
2023-04-11 18:42:39 - INFO - current_score 0.3660784803277024█████████████████████████████████████████████████████████████████████████████████████████████████████▊                | 9/10 [00:01<00:00,  6.72it/s]
Training:: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 222/222 [00:52<00:00,  4.25it/s]
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:01<00:00,  7.56it/s