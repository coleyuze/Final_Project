root@9cf9c6d4615a:~/test20230317base/task2# python -m src.train --gpu_ids='2' --bert_seq_length=128 --learning_rate=1e-4 --bert_learning_rate=5e-5 --savedmodel_path='data/checkpoint/0703_swa_10' --max_epochs=10 --batch_size=16 --adam_epsilon=1e-6 --weight_decay=0.01 --max_epochs=10 --test_batch_size=64 --val_batch_size=32 --batch_size=32
The GPUS ids:  2
Some weights of the model checkpoint at roberta-base were not used when initializing RobertaModel: ['lm_head.layer_norm.bias', 'lm_head.dense.weight', 'lm_head.layer_norm.weight', 'lm_head.decoder.weight', 'lm_head.bias', 'lm_head.dense.bias']
- This IS expected if you are initializing RobertaModel from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing RobertaModel from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
The train data length:  111
The valid data length:  19
2023-04-06 21:27:52 - INFO - Training/evaluation parameters: Namespace(adam_epsilon=1e-06, alpha=0, batch_size=32, bert_cache='data/bert_cache/', bert_dir='roberta-base', bert_embedding_size=768, bert_hidden_dropout_prob=0.1, bert_hidden_size=768, bert_learning_rate=5e-05, bert_max_steps=30000, bert_seq_length=128, bert_warmup_steps=5000, best_score=0.75, ckpt_file=None, class_label=3, constant_lr=False, device='cuda', distributed_train=False, dropout=0.3, ema_decay=0.999, ema_start=-1, embedding_freeze=False, fgm=0, gamma=0, gamma_focal=-1, gpu_ids='2', gradient_accumulation_steps=2, learning_rate=0.0001, max_epochs=10, max_grad_norm=1.0, max_steps=1110, minimum_lr=0.0, n_gpu=1, pgd=0, premise=False, pretrain_model_path=None, print_steps=100, result_file='result.tsv', save_steps=100, savedmodel_path='data/checkpoint/0703_swa_10', seed=42, swa_lr=5e-05, swa_start=-1, test_batch_size=64, test_path='data/validation.tsv', train_path='data/train.tsv', use_rdrop=False, val_batch_size=32, valid_path='data/validation.tsv', warmup_rate=0.1, warmup_steps=111, weight_decay=0.01)
Training::  89%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                 | 99/111 [00:18<00:02,  5.81it/s]2023-04-06 21:28:11 - INFO - Epoch 0total_step 100eta 00:03:07:loss 0.964, acc 0.625
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 19/19 [00:01<00:00, 16.63it/s]
2023-04-06 21:28:12 - INFO - current_score 0.5416360786482507████████████████████████████████████████████████████████████████████████████████████████████████████████████▌        | 18/19 [00:01<00:00, 16.53it/s]
Training:: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 111/111 [00:21<00:00,  5.15it/s]
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 19/19 [00:01<00:00, 16.79it/s]
Training::  79%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                 | 88/111 [00:15<00:03,  5.91it/s]2023-04-06 21:28:30 - INFO - Epoch 1total_step 200eta 00:02:52:loss 0.760, acc 0.656
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 19/19 [00:01<00:00, 16.74it/s]
2023-04-06 21:28:31 - INFO - current_score 0.6356581278500687████████████████████████████████████████████████████████████████████████████████████████████████████████████▌        | 18/19 [00:01<00:00, 16.60it/s]
Training:: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 111/111 [00:20<00:00,  5.51it/s]
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 19/19 [00:01<00:00, 16.75it/s]
Training::  69%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                 | 77/111 [00:13<00:05,  5.75it/s]2023-04-06 21:28:50 - INFO - Epoch 2total_step 300eta 00:02:35:loss 0.488, acc 0.812
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 19/19 [00:01<00:00, 16.50it/s]
2023-04-06 21:28:51 - INFO - current_score 0.7296050813934183████████████████████████████████████████████████████████████████████████████████████████████████████████████▌        | 18/19 [00:01<00:00, 16.20it/s]
Training:: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 111/111 [00:20<00:00,  5.46it/s]
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 19/19 [00:01<00:00, 15.10it/s]
Training::  59%|███████████████████████████████████████████████████████████████████████████████████████████████▋                                                                 | 66/111 [00:11<00:07,  5.84it/s]2023-04-06 21:29:10 - INFO - Epoch 3total_step 400eta 00:02:17:loss 0.702, acc 0.781
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 19/19 [00:01<00:00, 16.76it/s]
2023-04-06 21:29:11 - INFO - current_score 0.7351404003940234████████████████████████████████████████████████████████████████████████████████████████████████████████████▌        | 18/19 [00:01<00:00, 16.58it/s]
Training:: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 111/111 [00:20<00:00,  5.35it/s]
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 19/19 [00:01<00:00, 16.50it/s]
Training::  50%|███████████████████████████████████████████████████████████████████████████████▊                                                                                 | 55/111 [00:09<00:09,  5.80it/s]2023-04-06 21:29:30 - INFO - Epoch 4total_step 500eta 00:01:58:loss 0.339, acc 0.844
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 19/19 [00:01<00:00, 16.37it/s]
2023-04-06 21:29:31 - INFO - current_score 0.7088171593620918████████████████████████████████████████████████████████████████████████████████████████████████████████████▌        | 18/19 [00:01<00:00, 16.13it/s]
Training:: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 111/111 [00:20<00:00,  5.34it/s]
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 19/19 [00:01<00:00, 16.38it/s]
Training::  40%|███████████████████████████████████████████████████████████████▊                                                                                                 | 44/111 [00:07<00:11,  5.86it/s]2023-04-06 21:29:50 - INFO - Epoch 5total_step 600eta 00:01:39:loss 0.053, acc 1.000
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 19/19 [00:01<00:00, 16.51it/s]
2023-04-06 21:29:51 - INFO - current_score 0.7411683542342338████████████████████████████████████████████████████████████████████████████████████████████████████████████▌        | 18/19 [00:01<00:00, 16.31it/s]
Training:: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 111/111 [00:20<00:00,  5.45it/s]
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 19/19 [00:01<00:00, 16.75it/s]
2023-04-06 21:30:06 - INFO - best_score 0.7549879864508589
Training::  30%|███████████████████████████████████████████████▊                                                                                                                 | 33/111 [00:05<00:14,  5.56it/s]2023-04-06 21:30:12 - INFO - Epoch 6total_step 700eta 00:01:21:loss 0.119, acc 0.938
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 19/19 [00:01<00:00, 16.39it/s]
2023-04-06 21:30:13 - INFO - current_score 0.7519472488755421████████████████████████████████████████████████████████████████████████████████████████████████████████████▌        | 18/19 [00:01<00:00, 16.23it/s]
Training:: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 111/111 [00:20<00:00,  5.38it/s]
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 19/19 [00:01<00:00, 16.69it/s]
2023-04-06 21:30:30 - INFO - best_score 0.7659305264056662
Training::  20%|███████████████████████████████▉                                                                                                                                 | 22/111 [00:03<00:15,  5.84it/s]2023-04-06 21:30:34 - INFO - Epoch 7total_step 800eta 00:01:02:loss 0.125, acc 0.938
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 19/19 [00:01<00:00, 16.54it/s]
2023-04-06 21:30:35 - INFO - current_score 0.7493937360182688████████████████████████████████████████████████████████████████████████████████████████████████████████████▌        | 18/19 [00:01<00:00, 16.18it/s]
Training:: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 111/111 [00:20<00:00,  5.47it/s]
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 19/19 [00:01<00:00, 16.70it/s]
Training::  10%|███████████████▉                                                                                                                                                 | 11/111 [00:01<00:17,  5.85it/s]2023-04-06 21:30:53 - INFO - Epoch 8total_step 900eta 00:00:42:loss 0.060, acc 0.969
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 19/19 [00:01<00:00, 16.70it/s]
2023-04-06 21:30:54 - INFO - current_score 0.763674816563196█████████████████████████████████████████████████████████████████████████████████████████████████████████████▌        | 18/19 [00:01<00:00, 16.50it/s]
Training:: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 111/111 [00:20<00:00,  5.50it/s]
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 19/19 [00:01<00:00, 16.75it/s]
Training::   0%|                                                                                                                                                                          | 0/111 [00:00<?, ?it/s]2023-04-06 21:31:13 - INFO - Epoch 9total_step 1000eta 00:00:22:loss 0.020, acc 1.000
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 19/19 [00:01<00:00, 16.75it/s]
2023-04-06 21:31:14 - INFO - current_score 0.7538007517578822████████████████████████████████████████████████████████████████████████████████████████████████████████████▌        | 18/19 [00:01<00:00, 16.54it/s]
Training::  90%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏               | 100/111 [00:18<00:01,  5.79it/s]2023-04-06 21:31:31 - INFO - Epoch 9total_step 1100eta 00:00:01:loss 0.162, acc 0.938
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 19/19 [00:01<00:00, 16.64it/s]
2023-04-06 21:31:32 - INFO - current_score 0.7568173575067504████████████████████████████████████████████████████████████████████████████████████████████████████████████▌        | 18/19 [00:01<00:00, 16.53it/s]
Training:: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 111/111 [00:21<00:00,  5.20it/s]
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 19/19 [00:01<00:00, 16.73it/s