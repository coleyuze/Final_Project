root@9cf9c6d4615a:~/test20230317base/task2# python -m src.train --gpu_ids='2' --bert_seq_length=64 --learning_rate=1e-4 --bert_learning_rate=5e-5 --savedmodel_path='data/checkpoint/0703_swa_10' --max_epochs=10  --adam_epsilon=1e-6 --weight_decay=0.01 --test_batch_size=64 --val_batch_size=64 --batch_size=16 --embedding_freeze
addle !!!!!!!!!!!!!!!!!!!!!!!!!!!!
The GPUS ids:  2
'HTTPSConnectionPool(host='huggingface.co', port=443): Max retries exceeded with url: /roberta-base/resolve/main/config.json (Caused by ConnectTimeoutError(<urllib3.connection.VerifiedHTTPSConnection object at 0x7fac185485c0>, 'Connection to huggingface.co timed out. (connect timeout=10)'))' thrown while requesting HEAD https://huggingface.co/roberta-base/resolve/main/config.json
2023-04-10 18:51:30 - WARNING - 'HTTPSConnectionPool(host='huggingface.co', port=443): Max retries exceeded with url: /roberta-base/resolve/main/config.json (Caused by ConnectTimeoutError(<urllib3.connection.VerifiedHTTPSConnection object at 0x7fac185485c0>, 'Connection to huggingface.co timed out. (connect timeout=10)'))' thrown while requesting HEAD https://huggingface.co/roberta-base/resolve/main/config.json
Some weights of the model checkpoint at roberta-base were not used when initializing RobertaModel: ['lm_head.decoder.weight', 'lm_head.layer_norm.bias', 'lm_head.bias', 'lm_head.dense.bias', 'lm_head.dense.weight', 'lm_head.layer_norm.weight']
- This IS expected if you are initializing RobertaModel from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing RobertaModel from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
The train data length:  222
The valid data length:  10
冻结word embedding参数不训练!
2023-04-10 18:53:21 - INFO - Training/evaluation parameters: Namespace(adam_epsilon=1e-06, alpha=0, batch_size=16, bert_cache='data/bert_cache/', bert_dir='roberta-base', bert_embedding_size=768, bert_hidden_dropout_prob=0.1, bert_hidden_size=768, bert_learning_rate=5e-05, bert_max_steps=30000, bert_seq_length=64, bert_warmup_steps=5000, best_score=0.75, ckpt_file=None, class_label=3, constant_lr=False, device='cuda', distributed_train=False, dropout=0.3, ema_decay=0.999, ema_start=-1, embedding_freeze=True, fgm=0, gamma=0, gamma_focal=-1, gpu_ids='2', gradient_accumulation_steps=2, learning_rate=0.0001, max_epochs=10, max_grad_norm=1.0, max_steps=2220, minimum_lr=0.0, n_gpu=1, pgd=0, premise=False, pretrain_model_path=None, print_steps=100, result_file='result.tsv', save_steps=100, savedmodel_path='data/checkpoint/0703_swa_10', seed=42, swa_lr=5e-05, swa_start=-1, test_batch_size=64, test_path='data/validation.tsv', train_path='data/train.tsv', use_rdrop=False, val_batch_size=64, valid_path='data/validation.tsv', warmup_rate=0.1, warmup_steps=222, weight_decay=0.01)
Training::  45%|███████████████████████████████████████████████████████████████████████▊                                                                                         | 99/222 [00:09<00:10, 11.94it/s]2023-04-10 18:53:31 - INFO - Epoch 0total_step 100eta 00:03:14:loss 0.919, acc 0.750
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:00<00:00, 10.74it/s]
2023-04-10 18:53:32 - INFO - current_score 0.5144160242204814█████████████████████████████████████████████████████████████████████████████████████████████████████▊                | 9/10 [00:00<00:00, 10.23it/s]
Training::  90%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                | 199/222 [00:17<00:01, 13.63it/s]2023-04-10 18:53:39 - INFO - Epoch 0total_step 200eta 00:02:57:loss 0.953, acc 0.562
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:00<00:00, 11.93it/s]
2023-04-10 18:53:40 - INFO - current_score 0.5812461633598551█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:00<00:00, 12.67it/s]
Training:: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 222/222 [00:19<00:00, 11.10it/s]
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:00<00:00, 11.51it/s]
Training::  34%|███████████████████████████████████████████████████████                                                                                                          | 76/222 [00:05<00:11, 12.78it/s]2023-04-10 18:53:48 - INFO - Epoch 1total_step 300eta 00:02:52:loss 0.961, acc 0.375
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:00<00:00, 11.45it/s]
2023-04-10 18:53:49 - INFO - current_score 0.25691633283871085████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:00<00:00, 12.01it/s]
Training::  80%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                | 177/222 [00:15<00:03, 12.04it/s]2023-04-10 18:53:58 - INFO - Epoch 1total_step 400eta 00:02:44:loss 1.040, acc 0.375
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:00<00:00, 11.09it/s]
2023-04-10 18:53:59 - INFO - current_score 0.6004578168116967█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:00<00:00, 11.42it/s]
Training:: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 222/222 [00:19<00:00, 11.36it/s]
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:00<00:00, 11.33it/s]
Training::  24%|███████████████████████████████████████▏                                                                                                                         | 54/222 [00:04<00:12, 13.42it/s]2023-04-10 18:54:07 - INFO - Epoch 2total_step 500eta 00:02:36:loss 1.018, acc 0.562
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:00<00:00, 11.24it/s]
2023-04-10 18:54:08 - INFO - current_score 0.4705972599933318█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:00<00:00, 11.92it/s]
Training::  69%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                 | 154/222 [00:12<00:05, 13.08it/s]2023-04-10 18:54:16 - INFO - Epoch 2total_step 600eta 00:02:26:loss 1.067, acc 0.500
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:00<00:00, 11.48it/s]
2023-04-10 18:54:17 - INFO - current_score 0.4658387411108577█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:00<00:00, 12.17it/s]
Training:: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 222/222 [00:18<00:00, 11.89it/s]
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:00<00:00, 11.82it/s]
Training::  14%|███████████████████████▏                                                                                                                                         | 32/222 [00:02<00:14, 13.07it/s]2023-04-10 18:54:25 - INFO - Epoch 3total_step 700eta 00:02:17:loss 1.094, acc 0.312
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:00<00:00, 12.08it/s]
2023-04-10 18:54:26 - INFO - current_score 0.3381609649427159█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:00<00:00, 12.76it/s]
Training::  59%|███████████████████████████████████████████████████████████████████████████████████████████████▏                                                                | 132/222 [00:10<00:06, 14.09it/s]2023-04-10 18:54:33 - INFO - Epoch 3total_step 800eta 00:02:07:loss 1.068, acc 0.438
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:00<00:00, 12.38it/s]
2023-04-10 18:54:34 - INFO - current_score 0.36383579843175146████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:00<00:00, 12.27it/s]
Training:: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 222/222 [00:18<00:00, 12.29it/s]
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:00<00:00, 14.44it/s]
Training::   5%|███████▎                                                                                                                                                         | 10/222 [00:00<00:16, 13.10it/s]2023-04-10 18:54:42 - INFO - Epoch 4total_step 900eta 00:01:58:loss 1.075, acc 0.438
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:00<00:00, 13.80it/s]
2023-04-10 18:54:43 - INFO - current_score 0.2996998420221169█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:00<00:00, 14.63it/s]
Training::  50%|███████████████████████████████████████████████████████████████████████████████▎                                                                                | 110/222 [00:08<00:07, 14.46it/s]2023-04-10 18:54:50 - INFO - Epoch 4total_step 1000eta 00:01:47:loss 1.090, acc 0.375
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:00<00:00, 12.36it/s]
2023-04-10 18:54:51 - INFO - current_score 0.31686576494657875████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:00<00:00, 13.18it/s]
Training::  95%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎        | 210/222 [00:17<00:00, 12.73it/s]2023-04-10 18:54:59 - INFO - Epoch 4total_step 1100eta 00:01:38:loss 0.988, acc 0.625
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:00<00:00, 11.52it/s]
2023-04-10 18:54:59 - INFO - current_score 0.3130046731845293█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:00<00:00, 12.07it/s]
Training:: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 222/222 [00:19<00:00, 11.65it/s]
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:00<00:00, 11.39it/s]
Training::  40%|███████████████████████████████████████████████████████████████▊                                                                                                 | 88/222 [00:06<00:10, 12.86it/s]2023-04-10 18:55:08 - INFO - Epoch 5total_step 1200eta 00:01:30:loss 1.013, acc 0.438
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:00<00:00, 11.19it/s]
2023-04-10 18:55:09 - INFO - current_score 0.24770676691729324████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:00<00:00, 11.89it/s]
Training::  85%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                        | 188/222 [00:15<00:02, 12.12it/s]2023-04-10 18:55:17 - INFO - Epoch 5total_step 1300eta 00:01:21:loss 1.046, acc 0.375
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:00<00:00, 10.72it/s]
2023-04-10 18:55:18 - INFO - current_score 0.3641498783648348█████████████████████████████████████████████████████████████████████████████████████████████████████▊                | 9/10 [00:00<00:00, 10.14it/s]
Training:: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 222/222 [00:19<00:00, 11.32it/s]
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:00<00:00, 11.05it/s]
Training::  30%|███████████████████████████████████████████████▊                                                                                                                 | 66/222 [00:05<00:12, 12.86it/s]2023-04-10 18:55:27 - INFO - Epoch 6total_step 1400eta 00:01:13:loss 1.061, acc 0.438
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:00<00:00, 10.96it/s]
2023-04-10 18:55:28 - INFO - current_score 0.3039946971949648█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:00<00:00, 11.41it/s]
Training::  75%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                        | 166/222 [00:13<00:04, 13.26it/s]2023-04-10 18:55:36 - INFO - Epoch 6total_step 1500eta 00:01:04:loss 1.108, acc 0.250
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:00<00:00, 11.67it/s]
2023-04-10 18:55:36 - INFO - current_score 0.24770676691729324████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:00<00:00, 12.27it/s]
Training:: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 222/222 [00:19<00:00, 11.59it/s]
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:00<00:00, 11.33it/s]
Training::  20%|███████████████████████████████▉                                                                                                                                 | 44/222 [00:03<00:14, 12.54it/s]2023-04-10 18:55:45 - INFO - Epoch 7total_step 1600eta 00:00:55:loss 1.067, acc 0.438
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:00<00:00, 11.17it/s]
2023-04-10 18:55:46 - INFO - current_score 0.36383579843175146████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:00<00:00, 11.76it/s]
Training::  65%|███████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                        | 144/222 [00:12<00:06, 12.66it/s]2023-04-10 18:55:54 - INFO - Epoch 7total_step 1700eta 00:00:46:loss 1.039, acc 0.438
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:00<00:00, 11.42it/s]
2023-04-10 18:55:55 - INFO - current_score 0.36003206103000807████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:00<00:00, 11.87it/s]
Training:: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 222/222 [00:19<00:00, 11.54it/s]
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:00<00:00, 10.96it/s]
Training::  10%|███████████████▉                                                                                                                                                 | 22/222 [00:01<00:16, 12.14it/s]2023-04-10 18:56:04 - INFO - Epoch 8total_step 1800eta 00:00:37:loss 1.063, acc 0.625
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:00<00:00, 10.87it/s]
2023-04-10 18:56:05 - INFO - current_score 0.3103552014111539█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:00<00:00, 11.41it/s]
Training::  55%|███████████████████████████████████████████████████████████████████████████████████████▉                                                                        | 122/222 [00:10<00:07, 13.52it/s]2023-04-10 18:56:12 - INFO - Epoch 8total_step 1900eta 00:00:28:loss 1.073, acc 0.375
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:00<00:00, 12.14it/s]
2023-04-10 18:56:13 - INFO - current_score 0.29259567418867616████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:00<00:00, 12.75it/s]
Training:: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 222/222 [00:18<00:00, 11.91it/s]
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:00<00:00, 12.22it/s]
Training::   0%|                                                                                                                                                                          | 0/222 [00:00<?, ?it/s]2023-04-10 18:56:21 - INFO - Epoch 9total_step 2000eta 00:00:19:loss 1.100, acc 0.438
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:00<00:00, 11.90it/s]
2023-04-10 18:56:22 - INFO - current_score 0.33443796303619927████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:00<00:00, 12.48it/s]
Training::  45%|████████████████████████████████████████████████████████████████████████                                                                                        | 100/222 [00:08<00:09, 12.96it/s]2023-04-10 18:56:30 - INFO - Epoch 9total_step 2100eta 00:00:10:loss 1.065, acc 0.438
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:00<00:00, 10.96it/s]
2023-04-10 18:56:31 - INFO - current_score 0.3641498783648348█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:00<00:00, 11.59it/s]
Training::  90%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏               | 200/222 [00:16<00:01, 13.25it/s]2023-04-10 18:56:38 - INFO - Epoch 9total_step 2200eta 00:00:01:loss 1.065, acc 0.438
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:00<00:00, 11.47it/s]
2023-04-10 18:56:39 - INFO - current_score 0.37410592257552955████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:00<00:00, 11.86it/s]
Training:: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 222/222 [00:19<00:00, 11.39it/s]
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:00<00:00, 11.60it/s