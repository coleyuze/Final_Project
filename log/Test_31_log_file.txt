root@9cf9c6d4615a:~/test20230317base/task2# python -m src.train --gpu_ids='2' --bert_seq_length=128 --learning_rate=1e-4 --bert_learning_rate=5e-5 --savedmodel_path='data/checkpoint/0703_swa_10' --max_epochs=10  --adam_epsilon=1e-6 --weight_decay=0.01 --test_batch_size=64 --val_batch_size=64 --batch_size=16 --ema_start=0 --ema_decay=0.99
addle !!!!!!!!!!!!!!!!!!!!!!!!!!!!
The GPUS ids:  2
Some weights of the model checkpoint at roberta-base were not used when initializing RobertaModel: ['lm_head.layer_norm.weight', 'lm_head.layer_norm.bias', 'lm_head.dense.bias', 'lm_head.decoder.weight', 'lm_head.bias', 'lm_head.dense.weight']
- This IS expected if you are initializing RobertaModel from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing RobertaModel from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
The train data length:  222
The valid data length:  10
使用EMA！
2023-04-15 19:04:17 - INFO - Training/evaluation parameters: Namespace(adam_epsilon=1e-06, alpha=0, batch_size=16, bert_cache='data/bert_cache/', bert_dir='roberta-base', bert_embedding_size=768, bert_hidden_dropout_prob=0.1, bert_hidden_size=768, bert_learning_rate=5e-05, bert_max_steps=30000, bert_seq_length=128, bert_warmup_steps=5000, best_score=0.75, ckpt_file=None, class_label=3, constant_lr=False, device='cuda', distributed_train=False, dropout=0.3, ema_decay=0.99, ema_start=0, embedding_freeze=False, fgm=0, gamma=0, gamma_focal=-1, gpu_ids='2', gradient_accumulation_steps=2, learning_rate=0.0001, max_epochs=10, max_grad_norm=1.0, max_steps=2220, minimum_lr=0.0, n_gpu=1, pgd=0, premise=False, pretrain_model_path=None, print_steps=100, result_file='result.tsv', save_steps=100, savedmodel_path='data/checkpoint/0703_swa_10', seed=42, swa_lr=5e-05, swa_start=-1, test_batch_size=64, test_path='data/validation.tsv', train_path='data/train.tsv', use_rdrop=False, val_batch_size=64, valid_path='data/validation.tsv', warmup_rate=0.1, warmup_steps=222, weight_decay=0.01)
Training::  45%|███████████████████████████████████████████████████████████████████████▊                                                                                         | 99/222 [00:11<00:12,  9.90it/s]2023-04-15 19:04:28 - INFO - Epoch 0total_step 100eta 00:03:57:loss 0.923, acc 0.688
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:01<00:00,  9.24it/s]
2023-04-15 19:04:29 - INFO - current_score 0.4891930457163768█████████████████████████████████████████████████████████████████████████████████████████████████████▊                | 9/10 [00:01<00:00,  8.75it/s]
Training::  90%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                | 199/222 [00:22<00:02,  9.69it/s]2023-04-15 19:04:39 - INFO - Epoch 0total_step 200eta 00:03:46:loss 0.915, acc 0.562
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:01<00:00,  9.38it/s]
2023-04-15 19:04:40 - INFO - current_score 0.5654535407032777█████████████████████████████████████████████████████████████████████████████████████████████████████▊                | 9/10 [00:01<00:00,  8.83it/s]
Training:: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 222/222 [00:25<00:00,  8.61it/s]
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:01<00:00,  9.34it/s]
Training::  35%|███████████████████████████████████████████████████████▊                                                                                                         | 77/222 [00:07<00:14,  9.81it/s]2023-04-15 19:04:51 - INFO - Epoch 1total_step 300eta 00:03:42:loss 0.736, acc 0.688
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:01<00:00,  8.70it/s]
2023-04-15 19:04:53 - INFO - current_score 0.661970857669554██████████████████████████████████████████████████████████████████████████████████████████████████████▊                | 9/10 [00:01<00:00,  8.66it/s]
Training::  80%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                | 177/222 [00:19<00:04,  9.78it/s]2023-04-15 19:05:03 - INFO - Epoch 1total_step 400eta 00:03:30:loss 0.674, acc 0.875
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:01<00:00,  9.29it/s]
2023-04-15 19:05:04 - INFO - current_score 0.6656991018113988█████████████████████████████████████████████████████████████████████████████████████████████████████▊                | 9/10 [00:01<00:00,  8.74it/s]
Training:: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 222/222 [00:24<00:00,  8.90it/s]
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:01<00:00,  9.34it/s]
Training::  25%|███████████████████████████████████████▉                                                                                                                         | 55/222 [00:05<00:17,  9.77it/s]2023-04-15 19:05:15 - INFO - Epoch 2total_step 500eta 00:03:21:loss 0.552, acc 0.812
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:01<00:00,  9.35it/s]
2023-04-15 19:05:16 - INFO - current_score 0.7113266157428961█████████████████████████████████████████████████████████████████████████████████████████████████████▊                | 9/10 [00:01<00:00,  8.80it/s]
Training::  70%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                | 155/222 [00:16<00:06,  9.79it/s]2023-04-15 19:05:26 - INFO - Epoch 2total_step 600eta 00:03:08:loss 0.513, acc 0.875
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:01<00:00,  9.35it/s]
2023-04-15 19:05:28 - INFO - current_score 0.7375227795960702█████████████████████████████████████████████████████████████████████████████████████████████████████▊                | 9/10 [00:01<00:00,  8.78it/s]
Training:: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 222/222 [00:24<00:00,  8.94it/s]
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:01<00:00,  9.31it/s]
Training::  15%|███████████████████████▉                                                                                                                                         | 33/222 [00:03<00:19,  9.77it/s]2023-04-15 19:05:39 - INFO - Epoch 3total_step 700eta 00:02:58:loss 0.636, acc 0.750
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:01<00:00,  9.32it/s]
2023-04-15 19:05:40 - INFO - current_score 0.7463530020152327█████████████████████████████████████████████████████████████████████████████████████████████████████▊                | 9/10 [00:01<00:00,  8.77it/s]
Training::  60%|███████████████████████████████████████████████████████████████████████████████████████████████▊                                                                | 133/222 [00:14<00:09,  9.74it/s]2023-04-15 19:05:50 - INFO - Epoch 3total_step 800eta 00:02:46:loss 0.448, acc 0.875
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:01<00:00,  9.35it/s]
2023-04-15 19:05:51 - INFO - current_score 0.7445764888655834█████████████████████████████████████████████████████████████████████████████████████████████████████▊                | 9/10 [00:01<00:00,  8.80it/s]
Training:: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 222/222 [00:24<00:00,  8.92it/s]
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:01<00:00,  9.34it/s]
2023-04-15 19:06:04 - INFO - best_score 0.7519287955039435
Training::   5%|███████▉                                                                                                                                                         | 11/222 [00:01<00:21,  9.81it/s]2023-04-15 19:06:05 - INFO - Epoch 4total_step 900eta 00:02:39:loss 0.273, acc 0.938
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:01<00:00,  9.36it/s]
2023-04-15 19:06:06 - INFO - current_score 0.7487529092964491█████████████████████████████████████████████████████████████████████████████████████████████████████▊                | 9/10 [00:01<00:00,  8.81it/s]
Training::  50%|████████████████████████████████████████████████████████████████████████████████                                                                                | 111/222 [00:12<00:11,  9.74it/s]2023-04-15 19:06:17 - INFO - Epoch 4total_step 1000eta 00:02:26:loss 0.396, acc 0.875
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:01<00:00,  9.37it/s]
2023-04-15 19:06:21 - INFO - best_score 0.75743212356823██████████████████████████████████████████████████████████████████████████████████████████████████████████▊                | 9/10 [00:01<00:00,  8.79it/s]
2023-04-15 19:06:21 - INFO - current_score 0.75743212356823
Training::  95%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████        | 211/222 [00:26<00:01,  9.85it/s]2023-04-15 19:06:31 - INFO - Epoch 4total_step 1100eta 00:02:16:loss 0.129, acc 1.000
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:01<00:00,  9.35it/s]
2023-04-15 19:06:35 - INFO - best_score 0.7640191145122368████████████████████████████████████████████████████████████████████████████████████████████████████████▊                | 9/10 [00:01<00:00,  8.80it/s]
2023-04-15 19:06:35 - INFO - current_score 0.7640191145122368
Training:: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 222/222 [00:31<00:00,  7.04it/s]
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:01<00:00,  9.37it/s]
Training::  40%|████████████████████████████████████████████████████████████████▌                                                                                                | 89/222 [00:09<00:13,  9.75it/s]2023-04-15 19:06:46 - INFO - Epoch 5total_step 1200eta 00:02:06:loss 0.239, acc 0.875
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:01<00:00,  9.34it/s]
2023-04-15 19:06:47 - INFO - current_score 0.7591489659885886█████████████████████████████████████████████████████████████████████████████████████████████████████▊                | 9/10 [00:01<00:00,  8.78it/s]
Training::  85%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                       | 189/222 [00:20<00:03,  9.79it/s]2023-04-15 19:06:57 - INFO - Epoch 5total_step 1300eta 00:01:53:loss 0.040, acc 1.000
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:01<00:00,  9.38it/s]
2023-04-15 19:06:58 - INFO - current_score 0.7613897524647805█████████████████████████████████████████████████████████████████████████████████████████████████████▊                | 9/10 [00:01<00:00,  8.82it/s]
Training:: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 222/222 [00:24<00:00,  8.95it/s]
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:01<00:00,  9.37it/s]
2023-04-15 19:07:05 - INFO - best_score 0.7664670456520567
Training::  30%|████████████████████████████████████████████████▌                                                                                                                | 67/222 [00:06<00:15,  9.81it/s]2023-04-15 19:07:12 - INFO - Epoch 6total_step 1400eta 00:01:42:loss 0.039, acc 1.000
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:01<00:00,  9.29it/s]
2023-04-15 19:07:13 - INFO - current_score 0.7536946079857145█████████████████████████████████████████████████████████████████████████████████████████████████████▊                | 9/10 [00:01<00:00,  8.69it/s]
Training::  75%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                       | 167/222 [00:18<00:05,  9.82it/s]2023-04-15 19:07:24 - INFO - Epoch 6total_step 1500eta 00:01:29:loss 0.022, acc 1.000
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:01<00:00,  9.36it/s]
2023-04-15 19:07:25 - INFO - current_score 0.7469276178417521█████████████████████████████████████████████████████████████████████████████████████████████████████▊                | 9/10 [00:01<00:00,  8.80it/s]
Training:: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 222/222 [00:24<00:00,  8.94it/s]
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:01<00:00,  9.33it/s]
Training::  20%|████████████████████████████████▋                                                                                                                                | 45/222 [00:04<00:18,  9.74it/s]2023-04-15 19:07:36 - INFO - Epoch 7total_step 1600eta 00:01:17:loss 0.046, acc 1.000
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:01<00:00,  9.34it/s]
2023-04-15 19:07:37 - INFO - current_score 0.738169734097003██████████████████████████████████████████████████████████████████████████████████████████████████████▊                | 9/10 [00:01<00:00,  8.77it/s]
Training::  65%|████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                       | 145/222 [00:15<00:07,  9.79it/s]2023-04-15 19:07:47 - INFO - Epoch 7total_step 1700eta 00:01:04:loss 0.021, acc 1.000
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:01<00:00,  9.35it/s]
2023-04-15 19:07:48 - INFO - current_score 0.7379721317698418█████████████████████████████████████████████████████████████████████████████████████████████████████▊                | 9/10 [00:01<00:00,  8.79it/s]
Training:: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 222/222 [00:24<00:00,  8.93it/s]
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:01<00:00,  9.30it/s]
Training::  10%|████████████████▋                                                                                                                                                | 23/222 [00:02<00:20,  9.74it/s]2023-04-15 19:08:00 - INFO - Epoch 8total_step 1800eta 00:00:52:loss 0.051, acc 1.000
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:01<00:00,  9.33it/s]
2023-04-15 19:08:01 - INFO - current_score 0.7434732104327073█████████████████████████████████████████████████████████████████████████████████████████████████████▊                | 9/10 [00:01<00:00,  8.76it/s]
Training::  55%|████████████████████████████████████████████████████████████████████████████████████████▋                                                                       | 123/222 [00:13<00:10,  9.74it/s]2023-04-15 19:08:11 - INFO - Epoch 8total_step 1900eta 00:00:39:loss 0.008, acc 1.000
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:01<00:00,  9.31it/s]
2023-04-15 19:08:12 - INFO - current_score 0.7305611906138797█████████████████████████████████████████████████████████████████████████████████████████████████████▊                | 9/10 [00:01<00:00,  8.76it/s]
Training:: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 222/222 [00:24<00:00,  8.92it/s]
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:01<00:00,  9.33it/s]
Training::   0%|▋                                                                                                                                                                 | 1/222 [00:00<00:22,  9.70it/s]2023-04-15 19:08:23 - INFO - Epoch 9total_step 2000eta 00:00:27:loss 0.006, acc 1.000
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:01<00:00,  9.33it/s]
2023-04-15 19:08:25 - INFO - current_score 0.733641412902951██████████████████████████████████████████████████████████████████████████████████████████████████████▊                | 9/10 [00:01<00:00,  8.76it/s]
Training::  45%|████████████████████████████████████████████████████████████████████████▊                                                                                       | 101/222 [00:11<00:12,  9.81it/s]2023-04-15 19:08:35 - INFO - Epoch 9total_step 2100eta 00:00:14:loss 0.199, acc 0.875
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:01<00:00,  9.38it/s]
2023-04-15 19:08:36 - INFO - current_score 0.7440978482163679█████████████████████████████████████████████████████████████████████████████████████████████████████▊                | 9/10 [00:01<00:00,  8.80it/s]
Training::  91%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊               | 201/222 [00:22<00:02,  9.74it/s]2023-04-15 19:08:46 - INFO - Epoch 9total_step 2200eta 00:00:02:loss 0.110, acc 0.938
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:01<00:00,  9.39it/s]
2023-04-15 19:08:47 - INFO - current_score 0.7489161187163885█████████████████████████████████████████████████████████████████████████████████████████████████████▊                | 9/10 [00:01<00:00,  8.81it/s]
Training:: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 222/222 [00:25<00:00,  8.58it/s]
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:01<00:00,  9.37it/s